<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>EALib: ChromosomeCMA.h Source File</title>
<link href="EALib.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>ChromosomeCMA.h</h1><a href="_chromosome_c_m_a_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00090"></a>00090 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="preprocessor">#ifndef __CHROMOSOME_CMA_H</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#define __CHROMOSOME_CMA_H</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span>
<a name="l00095"></a><a class="code" href="_chromosome_c_m_a_8h.html#525335710b53cb064ca56b936120431e">00095</a> <span class="preprocessor">#define _USE_MATH_DEFINES</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="preprocessor">#include &lt;<a class="code" href="_chromosome_t_8h.html">EALib/ChromosomeT.h</a>&gt;</span>
<a name="l00099"></a>00099 <span class="preprocessor">#include &lt;<a class="code" href="sqr_8h.html">EALib/sqr.h</a>&gt;</span>
<a name="l00100"></a>00100 <span class="preprocessor">#include &lt;<a class="code" href="_population_8h.html">EALib/Population.h</a>&gt;</span>
<a name="l00101"></a>00101 <span class="preprocessor">#include &lt;Array/ArrayOp.h&gt;</span>
<a name="l00102"></a>00102 <span class="preprocessor">#include &lt;Array/ArrayIo.h&gt;</span>
<a name="l00103"></a>00103 <span class="preprocessor">#include &lt;LinAlg/linalg.h&gt;</span>
<a name="l00104"></a>00104 
<a name="l00105"></a><a class="code" href="_chromosome_c_m_a_8h.html#f1c964f667d5c4f45086b782b9db4759">00105</a> <span class="keyword">template</span> &lt; <span class="keyword">class</span> T &gt; <span class="keyword">inline</span> T <a class="code" href="_chromosome_c_m_a_8h.html#f1c964f667d5c4f45086b782b9db4759">min</a>( T a, T b ) 
<a name="l00106"></a>00106 { <span class="keywordflow">return</span> a &lt; b ? a : b; 
<a name="l00107"></a>00107 }
<a name="l00108"></a><a class="code" href="_chromosome_c_m_a_8h.html#a79d2df4c12f8f4927d88ddf7519e4c8">00108</a> <span class="keyword">template</span> &lt; <span class="keyword">class</span> T &gt; <span class="keyword">inline</span> T <a class="code" href="_chromosome_c_m_a_8h.html#a79d2df4c12f8f4927d88ddf7519e4c8">max</a>( T a, T b ) 
<a name="l00109"></a>00109 { <span class="keywordflow">return</span> a &gt; b ? a : b; 
<a name="l00110"></a>00110 }
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="class_chromosome_c_m_a.html">00113</a> <span class="keyword">class </span><a class="code" href="class_chromosome_c_m_a.html">ChromosomeCMA</a> : <span class="keyword">public</span> <a class="code" href="class_chromosome_t.html">ChromosomeT</a>&lt; double &gt;
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115 <span class="keyword">public</span>:
<a name="l00116"></a><a class="code" href="class_chromosome_c_m_a.html#9fd55364f569226002368c17e829fccf">00116</a>   <a class="code" href="class_chromosome_c_m_a.html#9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>( ) {};
<a name="l00117"></a><a class="code" href="class_chromosome_c_m_a.html#95df812c3337064c11b517c519e7b293">00117</a>   <span class="keyword">explicit</span> <a class="code" href="class_chromosome_c_m_a.html#9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>( <span class="keywordtype">unsigned</span> l ) : <a class="code" href="class_chromosome_t.html">ChromosomeT</a>&lt; double &gt;( l ) {};
<a name="l00118"></a><a class="code" href="class_chromosome_c_m_a.html#7e5d5a005e4d0e53819aeb875a0fddbc">00118</a>   <a class="code" href="class_chromosome_c_m_a.html#9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>( <span class="keywordtype">unsigned</span> l, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; v ): <a class="code" href="class_chromosome_t.html">ChromosomeT</a>&lt; double &gt;( l, v ) {};
<a name="l00119"></a><a class="code" href="class_chromosome_c_m_a.html#e151a2afca1f3a057a4a7e5900a94855">00119</a>   <a class="code" href="class_chromosome_c_m_a.html#9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>( <span class="keyword">const</span> std::vector&lt; double &gt;&amp; v ) : <a class="code" href="class_chromosome_t.html">ChromosomeT</a>&lt; double &gt;( v ) {};
<a name="l00120"></a><a class="code" href="class_chromosome_c_m_a.html#57bfe0dfab49974f0f848e3b1d6b2533">00120</a>   <a class="code" href="class_chromosome_c_m_a.html#57bfe0dfab49974f0f848e3b1d6b2533">~ChromosomeCMA</a>( ) {}; 
<a name="l00121"></a>00121 
<a name="l00122"></a><a class="code" href="class_chromosome_c_m_a.html#d491b3d662f1fe3c10a304295ce74019">00122</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome.html#8043a30b7ea0db65fc29c673d5e3edbc">init</a>(<span class="keywordtype">unsigned</span>             dimension, 
<a name="l00123"></a>00123             std::vector&lt;double &gt; stdv, 
<a name="l00124"></a>00124             <span class="keywordtype">double</span>               initialSigma,
<a name="l00125"></a>00125             <a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double&gt;</a> &amp;MinInit,
<a name="l00126"></a>00126             <a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double&gt;</a> &amp;MaxInit,
<a name="l00127"></a>00127             <span class="keywordtype">int</span>                  noOffspring = 1,
<a name="l00128"></a>00128             <span class="keywordtype">double</span>               lower       = 0.)  {
<a name="l00129"></a>00129     <span class="keywordtype">unsigned</span> <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>;
<a name="l00130"></a>00130     
<a name="l00131"></a>00131     <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>     = dimension;
<a name="l00132"></a>00132     <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a> = initialSigma;
<a name="l00133"></a>00133     
<a name="l00134"></a>00134     (*this).resize(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00135"></a>00135     
<a name="l00136"></a>00136     <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>.resize    (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00137"></a>00137     <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>.resize     (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>, <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>, <span class="keyword">false</span>);
<a name="l00138"></a>00138     <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>.resize     (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>, <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>, <span class="keyword">false</span>);
<a name="l00139"></a>00139     <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>.resize(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00140"></a>00140     <a class="code" href="class_chromosome_c_m_a.html#04af4d6b84b30a22370688388131783a">z</a>.resize          (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00141"></a>00141     <a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">lastStep</a>.resize   (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00142"></a>00142     
<a name="l00143"></a>00143     <a class="code" href="class_chromosome_t__num.html#bf93db3bf51ecf36602cadbc6938d970">initialize</a>(MinInit, MaxInit);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a> = noOffspring;
<a name="l00146"></a>00146     <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>      = 2. / (2. + <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00147"></a>00147     <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>    = 2. / (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>*<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>+6.); 
<a name="l00148"></a>00148     
<a name="l00149"></a>00149     <a class="code" href="class_chromosome_c_m_a.html#21738e88ab39e19ad2d26b569a25daab">lambdaSucc</a> = 0.;
<a name="l00150"></a>00150     <a class="code" href="class_chromosome_c_m_a.html#55a9eaa2f6af39dbd21f9ee343dd2697">noOffspringSinceUpdate</a> = 0;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <a class="code" href="class_chromosome_c_m_a.html#e0f283f67eaef767de972cd12d5ae803">lowerBound</a> = lower;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">// succprob, p_succ </span>
<a name="l00155"></a>00155     <a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a> = 1./(5. + sqrt((<span class="keywordtype">double</span>)<a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>)/2.); 
<a name="l00156"></a>00156     <span class="comment">//psPrime = 1. / 2. * 1./(5. + (double)lambda/4.); </span>
<a name="l00157"></a>00157     <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>      = <a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a>;
<a name="l00158"></a>00158     
<a name="l00159"></a>00159     <a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">cp</a> = (<a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a> * lambda) / (2 +  <a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a> * lambda);
<a name="l00160"></a>00160     
<a name="l00161"></a>00161     <a class="code" href="class_chromosome_c_m_a.html#8545182b9d1239593da29fb232e884ad">d</a> = 1 + <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a> / (lambda * 2);
<a name="l00162"></a>00162     
<a name="l00163"></a>00163     <span class="comment">// init paths</span>
<a name="l00164"></a>00164     <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>; i++) {
<a name="l00165"></a>00165       <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) = 0.;
<a name="l00166"></a>00166       <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>++) {
<a name="l00167"></a>00167         <span class="keywordflow">if</span>(i!=<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>) <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i,<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>) = 0;
<a name="l00168"></a>00168         <span class="keywordflow">else</span> <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i,<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>) = <a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(stdv[i]);
<a name="l00169"></a>00169       }
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171     <span class="comment">// eigenvalues and eigenvector matrix B</span>
<a name="l00172"></a>00172     eigensymm(<a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>, <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>, <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>);
<a name="l00173"></a>00173     <a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">needCovarianceUpdate</a> = <span class="keyword">false</span>;
<a name="l00174"></a>00174   } 
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="class_chromosome_c_m_a.html#61cc908956cacea0d07085fda580ea71">00176</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome.html#8043a30b7ea0db65fc29c673d5e3edbc">init</a>(<span class="keywordtype">unsigned</span> dimension, 
<a name="l00177"></a>00177             <span class="keywordtype">double</span>   initialSigma,              
<a name="l00178"></a>00178             <span class="keywordtype">double</span>   MinInit,
<a name="l00179"></a>00179             <span class="keywordtype">double</span>   MaxInit,
<a name="l00180"></a>00180             <span class="keywordtype">int</span>      <a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>=1) {
<a name="l00181"></a>00181     std::vector&lt;double&gt; stdv(dimension);
<a name="l00182"></a>00182     <a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double&gt;</a> chromeMinInit(dimension), chromeMaxInit(dimension);
<a name="l00183"></a>00183     
<a name="l00184"></a>00184     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; dimension; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++) {
<a name="l00185"></a>00185       stdv         [<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>] = 1;
<a name="l00186"></a>00186       chromeMinInit[<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>] = MinInit;
<a name="l00187"></a>00187       chromeMaxInit[<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>] = MaxInit;
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189     <a class="code" href="class_chromosome.html#8043a30b7ea0db65fc29c673d5e3edbc">init</a>(dimension, stdv, initialSigma, chromeMinInit, chromeMaxInit, <a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>);
<a name="l00190"></a>00190   }
<a name="l00191"></a>00191   
<a name="l00192"></a><a class="code" href="class_chromosome_c_m_a.html#9dc182910ec7f5aae352548c8988adda">00192</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#9dc182910ec7f5aae352548c8988adda">mutate</a>() {
<a name="l00193"></a>00193     <span class="comment">// draw random vector</span>
<a name="l00194"></a>00194     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++) <a class="code" href="class_chromosome_c_m_a.html#04af4d6b84b30a22370688388131783a">z</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>) = Rng::gauss(0,1);
<a name="l00195"></a>00195     <a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">lastStep</a> = 0;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="comment">// mutate objective variables, Eq. (1)</span>
<a name="l00198"></a>00198     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++)
<a name="l00199"></a>00199       <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>++) 
<a name="l00200"></a>00200         <a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">lastStep</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>) += <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>,<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>) * sqrt(fabs(<a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>))) * <a class="code" href="class_chromosome_c_m_a.html#04af4d6b84b30a22370688388131783a">z</a>(j);
<a name="l00201"></a>00201     
<a name="l00202"></a>00202     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++)
<a name="l00203"></a>00203       (*<span class="keyword">this</span>)[<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>] += <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a> * <a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">lastStep</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>);
<a name="l00204"></a>00204 
<a name="l00205"></a>00205     <a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">needCovarianceUpdate</a> = <span class="keyword">true</span>;
<a name="l00206"></a>00206   };
<a name="l00207"></a>00207 
<a name="l00208"></a><a class="code" href="class_chromosome_c_m_a.html#a596d8a5a52f7918b3ec08ebdcc37b9e">00208</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#a596d8a5a52f7918b3ec08ebdcc37b9e">updateGlobalStepsize</a>() {
<a name="l00209"></a>00209     <a class="code" href="class_chromosome_c_m_a.html#a596d8a5a52f7918b3ec08ebdcc37b9e">updateGlobalStepsize</a>(<a class="code" href="class_chromosome_c_m_a.html#21738e88ab39e19ad2d26b569a25daab">lambdaSucc</a> / <a class="code" href="class_chromosome_c_m_a.html#55a9eaa2f6af39dbd21f9ee343dd2697">noOffspringSinceUpdate</a>);
<a name="l00210"></a>00210     <a class="code" href="class_chromosome_c_m_a.html#21738e88ab39e19ad2d26b569a25daab">lambdaSucc</a> = 0.;
<a name="l00211"></a>00211     <a class="code" href="class_chromosome_c_m_a.html#55a9eaa2f6af39dbd21f9ee343dd2697">noOffspringSinceUpdate</a> = 0;
<a name="l00212"></a>00212   }
<a name="l00213"></a>00213 
<a name="l00214"></a><a class="code" href="class_chromosome_c_m_a.html#ad313284fa6f3f52d0e3f5eb15079496">00214</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#ad313284fa6f3f52d0e3f5eb15079496">updateLambdaSucc</a>(<span class="keywordtype">bool</span> better) {
<a name="l00215"></a>00215     <a class="code" href="class_chromosome_c_m_a.html#55a9eaa2f6af39dbd21f9ee343dd2697">noOffspringSinceUpdate</a>++;
<a name="l00216"></a>00216     <span class="keywordflow">if</span>(better) <a class="code" href="class_chromosome_c_m_a.html#21738e88ab39e19ad2d26b569a25daab">lambdaSucc</a>++;
<a name="l00217"></a>00217   }
<a name="l00218"></a>00218 
<a name="l00219"></a><a class="code" href="class_chromosome_c_m_a.html#163d8d16152d910e235f308fe96928d2">00219</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#a596d8a5a52f7918b3ec08ebdcc37b9e">updateGlobalStepsize</a>(<span class="keywordtype">double</span> nsucc) {
<a name="l00220"></a>00220     <span class="comment">// Step size update by accumulated success probability</span>
<a name="l00221"></a>00221     <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>    = (1 - <a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">cp</a>) * <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a> + <a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">cp</a> *(nsucc/<a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>);
<a name="l00222"></a>00222     <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a> *= exp( (<a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a> - (<a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a>/(1-<a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a>))*(1-<a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>)) / <a class="code" href="class_chromosome_c_m_a.html#8545182b9d1239593da29fb232e884ad">d</a>);
<a name="l00223"></a>00223     
<a name="l00224"></a>00224     <span class="keywordflow">if</span> ((<a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a> * sqrt(fabs(<a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a> - 1)))) &lt; <a class="code" href="class_chromosome_c_m_a.html#e0f283f67eaef767de972cd12d5ae803">lowerBound</a>)
<a name="l00225"></a>00225       <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a> = <a class="code" href="class_chromosome_c_m_a.html#e0f283f67eaef767de972cd12d5ae803">lowerBound</a> / sqrt(fabs(<a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a> - 1)));
<a name="l00226"></a>00226   };
<a name="l00227"></a>00227   
<a name="l00228"></a><a class="code" href="class_chromosome_c_m_a.html#e3b0b97139d93901c98e5a4daa18ead3">00228</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#7436ca0927ceeb2fe64a973325a50554">updateCovariance</a>(<a class="code" href="class_individual.html">Individual</a>&amp; parent) {
<a name="l00229"></a>00229     <span class="comment">// Eq. (2) &amp; Eq. (4)</span>
<a name="l00230"></a>00230     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++) {
<a name="l00231"></a>00231       <span class="keywordflow">if</span>(<a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>&lt;0.44) <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>) = (1 - <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>) 
<a name="l00232"></a>00232                     + sqrt(<a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>*(2-<a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>))
<a name="l00233"></a>00233                     * ( (*<span class="keyword">this</span>)[i] - (<span class="keyword">dynamic_cast</span>&lt;std::vector&lt;double &gt; &amp;&gt;(parent[0]))[i] ) / <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a>;
<a name="l00234"></a>00234       <span class="keywordflow">else</span> <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) = (1 - <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i);
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++) {
<a name="l00239"></a>00239       <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>++) {
<a name="l00240"></a>00240         <span class="keywordflow">if</span>(<a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>&gt;=0.44) <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>, <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> ) = (1-<a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>) * <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>, <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> ) 
<a name="l00241"></a>00241                        + <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a> * (<a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>) + <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a> * (2-<a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>) * <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i, j ));
<a name="l00242"></a>00242         <span class="keywordflow">else</span> <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i, j ) = (1-<a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>) * <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i, j ) 
<a name="l00243"></a>00243                + <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a> * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(j);
<a name="l00244"></a>00244       }
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">// eigenvalues eigenvalues and eigenvector matrix B</span>
<a name="l00248"></a>00248     eigensymm(<a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>, <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>, <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">needCovarianceUpdate</a> = <span class="keyword">false</span>;
<a name="l00251"></a>00251   };
<a name="l00252"></a>00252 
<a name="l00253"></a><a class="code" href="class_chromosome_c_m_a.html#7436ca0927ceeb2fe64a973325a50554">00253</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#7436ca0927ceeb2fe64a973325a50554">updateCovariance</a>() {
<a name="l00254"></a>00254     <span class="comment">// Eq. (2) &amp; Eq. (4)</span>
<a name="l00255"></a>00255     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++) {
<a name="l00256"></a>00256       <span class="keywordflow">if</span>(<a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>&lt;0.44) <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>) = (1 - <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>) + sqrt(<a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>*(2-<a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>)) * <a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">lastStep</a>(i);
<a name="l00257"></a>00257       <span class="keywordflow">else</span> <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) = (1 - <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i);
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260     <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>++) {
<a name="l00261"></a>00261       <span class="keywordflow">for</span>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> = 0; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> &lt; n; <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>++) {
<a name="l00262"></a>00262         <span class="keywordflow">if</span>(<a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>&gt;=0.44) <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>, <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> ) = (1-<a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>) * <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(<a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>, <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a> ) 
<a name="l00263"></a>00263                        + <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a> * (<a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(<a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>) + <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a> * (2-<a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>) * <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i, j ));
<a name="l00264"></a>00264         <span class="keywordflow">else</span> <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i, j ) = (1-<a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>) * <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>(i, j ) 
<a name="l00265"></a>00265                + <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a> * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) * <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(j);
<a name="l00266"></a>00266       }
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="comment">// eigenvalues eigenvalues and eigenvector matrix B</span>
<a name="l00270"></a>00270     eigensymm(<a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>, <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>, <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272     <a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">needCovarianceUpdate</a> = <span class="keyword">false</span>;
<a name="l00273"></a>00273   };
<a name="l00274"></a>00274 
<a name="l00275"></a><a class="code" href="class_chromosome_c_m_a.html#e6123ca2088cafc3ee48ad993902c824">00275</a>   <span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="class_chromosome_c_m_a.html#e6123ca2088cafc3ee48ad993902c824">getC</a>() { <span class="keywordflow">return</span> <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>; }
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="class_chromosome_c_m_a.html#dbcad88b6bb37a6f6d08513ec54d94f3">00277</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#dbcad88b6bb37a6f6d08513ec54d94f3">getSigma</a>() { <span class="keywordflow">return</span> <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a>; };
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="class_chromosome_c_m_a.html#62d8b1069f5e5f1ec56256cbaf56e6b9">00279</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#62d8b1069f5e5f1ec56256cbaf56e6b9">getCondition</a>() { <span class="keywordflow">return</span> <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(0) / <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>-1); }
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="class_chromosome_c_m_a.html#ff5175e40c6e9770a6e8ad96442efb7e">00281</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#ff5175e40c6e9770a6e8ad96442efb7e">getPath</a>() { <span class="keywordflow">return</span> <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>; };
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="class_chromosome_c_m_a.html#eea2a4a17a9682504372441403653801">00283</a>   <span class="keywordtype">void</span> <a class="code" href="class_chromosome_c_m_a.html#eea2a4a17a9682504372441403653801">setLower</a>(<span class="keywordtype">double</span> lower) { <a class="code" href="class_chromosome_c_m_a.html#e0f283f67eaef767de972cd12d5ae803">lowerBound</a> = lower; }
<a name="l00284"></a>00284 
<a name="l00285"></a><a class="code" href="class_chromosome_c_m_a.html#0ed4977152d799f705e899e7c11cec43">00285</a>   <span class="keywordtype">bool</span> <a class="code" href="class_chromosome_c_m_a.html#0ed4977152d799f705e899e7c11cec43">covarianceUpdateNeeded</a>() { <span class="keywordflow">return</span> <a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">needCovarianceUpdate</a>; }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="keyword">protected</span>:
<a name="l00288"></a><a class="code" href="class_chromosome_c_m_a.html#885b17019f0bd16849e7e1ed860b59e8">00288</a>   <a class="code" href="class_chromosome.html">Chromosome</a>* <a class="code" href="class_chromosome_c_m_a.html#885b17019f0bd16849e7e1ed860b59e8">clone</a>( )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_chromosome_c_m_a.html#9fd55364f569226002368c17e829fccf">ChromosomeCMA</a>( *<span class="keyword">this</span> ); }
<a name="l00289"></a><a class="code" href="class_chromosome_c_m_a.html#8e16cce0d08f19e5515c8d0382213e86">00289</a>   <a class="code" href="class_chromosome.html">Chromosome</a>* <a class="code" href="class_chromosome_c_m_a.html#8e16cce0d08f19e5515c8d0382213e86">empty</a>( )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_chromosome_c_m_a.html">ChromosomeCMA</a>; }
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="class_chromosome_c_m_a.html#2568f3b4e7a5721b3c9a63ceb2130612">00291</a>   <span class="keywordtype">int</span> <a class="code" href="class_chromosome_c_m_a.html#2568f3b4e7a5721b3c9a63ceb2130612">pvm_pkchrom</a>() {
<a name="l00292"></a>00292     <span class="keywordtype">unsigned</span>  <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>;
<a name="l00293"></a>00293     <span class="keywordtype">double</span>*   u;
<a name="l00294"></a>00294     <span class="keywordtype">unsigned</span>* s;                
<a name="l00295"></a>00295     
<a name="l00296"></a>00296     this-&gt;<a class="code" href="class_chromosome.html#8fdac097cf9dd4f13ad6d404563acd37">ChromosomeT&lt;double&gt;::pvm_pkchrom</a>();
<a name="l00297"></a>00297     
<a name="l00298"></a>00298     s = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[2];                                
<a name="l00299"></a>00299     s[0] = <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>;
<a name="l00300"></a>00300     s[1] = <a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>;
<a name="l00301"></a>00301     <a class="code" href="_p_v_minterface_8cpp.html#80a9f340ec569800544fbdd668546334">pvm_pkuint</a>(s,2,1);
<a name="l00302"></a>00302     <span class="keyword">delete</span>[] s; 
<a name="l00303"></a>00303     
<a name="l00304"></a>00304     u = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="_chromosome_c_m_a_8h.html#f1c964f667d5c4f45086b782b9db4759">min</a>(7u,<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>*<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>)];
<a name="l00305"></a>00305     u[0]= <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a>;
<a name="l00306"></a>00306     u[1]= <a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a>;
<a name="l00307"></a>00307     u[2]= <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>;
<a name="l00308"></a>00308     u[3]= <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>;
<a name="l00309"></a>00309     u[4]= <a class="code" href="class_chromosome_c_m_a.html#8545182b9d1239593da29fb232e884ad">d</a>;
<a name="l00310"></a>00310     u[5]= <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>;
<a name="l00311"></a>00311     u[6]= <a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">cp</a>;
<a name="l00312"></a>00312     <a class="code" href="_p_v_minterface_8cpp.html#0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u,7,1);
<a name="l00313"></a>00313     
<a name="l00314"></a>00314     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) u[i]=<a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i);
<a name="l00315"></a>00315     <a class="code" href="_p_v_minterface_8cpp.html#0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u,n,1);
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) u[i]=<a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(i);
<a name="l00318"></a>00318     <a class="code" href="_p_v_minterface_8cpp.html#0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u,n,1);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) u[i]=<a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>.elem(i);
<a name="l00321"></a>00321     <a class="code" href="_p_v_minterface_8cpp.html#0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u,n*n,1);
<a name="l00322"></a>00322 
<a name="l00323"></a>00323     <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) u[i]=<a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>.elem(i);
<a name="l00324"></a>00324     <a class="code" href="_p_v_minterface_8cpp.html#0d39a4495259a59feec9c3a50a24d247">pvm_pkdouble</a>(u,n*n,1);
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     <span class="keyword">delete</span>[] u;
<a name="l00327"></a>00327     <span class="keywordflow">return</span> 1;
<a name="l00328"></a>00328   };
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="class_chromosome_c_m_a.html#e4827a99d256835d16513b7f66a84da3">00330</a>   <span class="keywordtype">int</span> <a class="code" href="class_chromosome_c_m_a.html#e4827a99d256835d16513b7f66a84da3">pvm_upkchrom</a>() {
<a name="l00331"></a>00331     <span class="keywordtype">unsigned</span>  <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>;
<a name="l00332"></a>00332     <span class="keywordtype">double</span>*   u;
<a name="l00333"></a>00333     <span class="keywordtype">unsigned</span>* s;
<a name="l00334"></a>00334     
<a name="l00335"></a>00335     this-&gt;<a class="code" href="class_chromosome.html#e2e3a21ead9aad46c681fded85657348">ChromosomeT&lt;double&gt;::pvm_upkchrom</a>();
<a name="l00336"></a>00336     
<a name="l00337"></a>00337     s = <span class="keyword">new</span> <span class="keywordtype">unsigned</span>[2];                                
<a name="l00338"></a>00338     <a class="code" href="_p_v_minterface_8cpp.html#80a9f340ec569800544fbdd668546334">pvm_pkuint</a>(s,2,1);
<a name="l00339"></a>00339     <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>       = s[0];
<a name="l00340"></a>00340     <a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>  = s[1];
<a name="l00341"></a>00341     <span class="keyword">delete</span>[] s; 
<a name="l00342"></a>00342     
<a name="l00343"></a>00343     <span class="keywordflow">if</span>(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>!=this-&gt;size()) {
<a name="l00344"></a>00344       std::cerr &lt;&lt; <span class="stringliteral">"ChromosomeCMA: size missmatch within PVM send routines!"</span> 
<a name="l00345"></a>00345                 &lt;&lt; std::endl;
<a name="l00346"></a>00346       exit(EXIT_FAILURE);
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348 
<a name="l00349"></a>00349     <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>.resize(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00350"></a>00350     <a class="code" href="class_chromosome_c_m_a.html#04af4d6b84b30a22370688388131783a">z</a>.     <a class="code" href="class_chromosome_t__base.html#f222e374790b377bce4ce137b9c8b679">resize</a>(<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00351"></a>00351     <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>.resize    (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00352"></a>00352     <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>.resize     (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>, <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00353"></a>00353     <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>.resize     (<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>, <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>);
<a name="l00354"></a>00354     
<a name="l00355"></a>00355     u = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="_chromosome_c_m_a_8h.html#f1c964f667d5c4f45086b782b9db4759">min</a>(7u,<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>*<a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>)];
<a name="l00356"></a>00356     <a class="code" href="_p_v_minterface_8cpp.html#1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u,7,1);
<a name="l00357"></a>00357     <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a>   = u[0];
<a name="l00358"></a>00358     <a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a> = u[1];
<a name="l00359"></a>00359     <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>      = u[2];
<a name="l00360"></a>00360     <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>    = u[3];
<a name="l00361"></a>00361     <a class="code" href="class_chromosome_c_m_a.html#8545182b9d1239593da29fb232e884ad">d</a>       = u[4];
<a name="l00362"></a>00362     <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>      = u[5];
<a name="l00363"></a>00363     <a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">cp</a>      = u[6];
<a name="l00364"></a>00364 
<a name="l00365"></a>00365     <a class="code" href="_p_v_minterface_8cpp.html#1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u,n,1);
<a name="l00366"></a>00366     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>(i) = u[i];
<a name="l00367"></a>00367     
<a name="l00368"></a>00368     <a class="code" href="_p_v_minterface_8cpp.html#1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u,n,1);
<a name="l00369"></a>00369     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>(i) = u[i];
<a name="l00370"></a>00370     
<a name="l00371"></a>00371     <a class="code" href="_p_v_minterface_8cpp.html#1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u,n*n,1);
<a name="l00372"></a>00372     <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>.elem(i) = u[i];
<a name="l00373"></a>00373     
<a name="l00374"></a>00374     <a class="code" href="_p_v_minterface_8cpp.html#1198e984dc3eadf9f34c709a164689b0">pvm_upkdouble</a>(u,n*n,1);
<a name="l00375"></a>00375     <span class="keywordflow">for</span> (i = 0; i &lt; n*n; i++) <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>.elem(i) = u[i];
<a name="l00376"></a>00376     
<a name="l00377"></a>00377     <span class="keyword">delete</span>[] u;
<a name="l00378"></a>00378     <span class="keywordflow">return</span> 1;
<a name="l00379"></a><a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">00379</a>   };
<a name="l00380"></a>00380 
<a name="l00381"></a>00381 <span class="keyword">private</span>:
<a name="l00382"></a>00382   <span class="keywordtype">unsigned</span> <a class="code" href="class_chromosome_c_m_a.html#be9cee180e171df99a7949afd458a2b7">n</a>;           <span class="comment">// Dimension // problem dimension / chromosome length</span>
<a name="l00383"></a><a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">00383</a>   <span class="keywordtype">unsigned</span> <a class="code" href="class_chromosome_c_m_a.html#e6bef023b1bbbeeb185eb7e420fb4170">lambda</a>;      <span class="comment">//           // size of offspring population</span>
<a name="l00384"></a><a class="code" href="class_chromosome_c_m_a.html#af64b5b088a907ed974866860d930d69">00384</a>   <span class="keywordtype">unsigned</span> <a class="code" href="class_chromosome_c_m_a.html#f37daf8190e79440629bc9c8aa8d0843">i</a>, <a class="code" href="class_chromosome_c_m_a.html#7b96160e5010e971ef0d06b0210d182b">j</a>, <a class="code" href="class_chromosome_c_m_a.html#af64b5b088a907ed974866860d930d69">k</a>;     <span class="comment">//           // iterators</span>
<a name="l00385"></a><a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">00385</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#e07dfb1154fb7202544fb0ab16b0271c">sigma</a>;         <span class="comment">// delta     // the current global stepsize</span>
<a name="l00386"></a><a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">00386</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#696efe8289b4388aad07a486f92396cb">psPrime</a>;       <span class="comment">//           // target success probability; strategy constant for global stepsize update</span>
<a name="l00387"></a><a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">00387</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#2616e60fb53bc93bdcb3d46ef055dc7a">cc</a>;            <span class="comment">// c         // strategy constant for cma culmulation update </span>
<a name="l00388"></a><a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">00388</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#1bc363672efae9da99a9988f70967592">ccov</a>;          <span class="comment">//           // strategy constant for cma update</span>
<a name="l00389"></a><a class="code" href="class_chromosome_c_m_a.html#8545182b9d1239593da29fb232e884ad">00389</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#8545182b9d1239593da29fb232e884ad">d</a>;
<a name="l00390"></a><a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">00390</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#cb037cf77fb7156f6fa2b7a77adae3fa">cp</a>;
<a name="l00391"></a><a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">00391</a>   <span class="keywordtype">double</span> <a class="code" href="class_chromosome_c_m_a.html#9e74cc2e5748b7ba4a0f90353dd16c7d">ps</a>;            <span class="comment">// avsuccess // global stepsize culmulation path </span>
<a name="l00392"></a><a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">00392</a>   Array&lt;double&gt; <a class="code" href="class_chromosome_c_m_a.html#11203df27909205628eee9e6c69e1bea">pc</a>;     <span class="comment">// s         // evo cumulation path</span>
<a name="l00393"></a><a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">00393</a>   Array2D&lt;double&gt; <a class="code" href="class_chromosome_c_m_a.html#fd8ce18a5739d403ffdc6555596acdea">C</a>;    <span class="comment">//           // the current covariance matrix</span>
<a name="l00394"></a><a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">00394</a>   Array2D&lt;double&gt; <a class="code" href="class_chromosome_c_m_a.html#4f24be7488840ce1fa5b39209ff984f8">B</a>;    <span class="comment">//           // eigenvector matrix C for offspring sampling</span>
<a name="l00395"></a><a class="code" href="class_chromosome_c_m_a.html#04af4d6b84b30a22370688388131783a">00395</a>   Array&lt;double&gt; <a class="code" href="class_chromosome_c_m_a.html#04af4d6b84b30a22370688388131783a">z</a>;      <span class="comment">// standard normally distributed mutation vector</span>
<a name="l00396"></a><a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">00396</a>   Array&lt;double&gt; <a class="code" href="class_chromosome_c_m_a.html#6f8f7d250168911e05a66902479eb6e4">eigenvalues</a>;         <span class="comment">// eigenvalue vector of C for offspring sampling</span>
<a name="l00397"></a><a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">00397</a>   Array&lt;double&gt; <a class="code" href="class_chromosome_c_m_a.html#0d5131653eda6f538c64f51327cdae70">lastStep</a>;      <span class="comment">// </span>
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="class_chromosome_c_m_a.html#55a9eaa2f6af39dbd21f9ee343dd2697">00399</a>   <span class="keywordtype">unsigned</span>      <a class="code" href="class_chromosome_c_m_a.html#55a9eaa2f6af39dbd21f9ee343dd2697">noOffspringSinceUpdate</a>;
<a name="l00400"></a><a class="code" href="class_chromosome_c_m_a.html#21738e88ab39e19ad2d26b569a25daab">00400</a>   <span class="keywordtype">double</span>        <a class="code" href="class_chromosome_c_m_a.html#21738e88ab39e19ad2d26b569a25daab">lambdaSucc</a>;
<a name="l00401"></a><a class="code" href="class_chromosome_c_m_a.html#e0f283f67eaef767de972cd12d5ae803">00401</a>   <span class="keywordtype">double</span>        <a class="code" href="class_chromosome_c_m_a.html#e0f283f67eaef767de972cd12d5ae803">lowerBound</a>;
<a name="l00402"></a><a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">00402</a>   <span class="keywordtype">bool</span> <a class="code" href="class_chromosome_c_m_a.html#428cee52af7f148570ba8f9fa2a6bf90">needCovarianceUpdate</a>;
<a name="l00403"></a>00403 };
<a name="l00404"></a>00404 <span class="preprocessor">#endif</span>
<a name="l00405"></a>00405 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Mar 23 10:37:02 2009 for EALib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
