<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Rng: LogNormal.cpp Source File</title>
<link href="Rng.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>LogNormal.cpp</h1><a href="_log_normal_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00064"></a>00064 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="preprocessor">#include "<a class="code" href="_log_normal_8h.html">Rng/LogNormal.h</a>"</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">//========================================================================</span>
<a name="l00099"></a><a class="code" href="class_log_normal.html#185b4fd84954b5e665c8261505e52beb">00099</a> <span class="comment"></span><a class="code" href="class_log_normal.html#185b4fd84954b5e665c8261505e52beb">LogNormal::LogNormal</a>( <span class="keywordtype">double</span> mean, <span class="keywordtype">double</span> variance )
<a name="l00100"></a>00100   : logMean    ( mean ),
<a name="l00101"></a>00101     logVariance( variance )
<a name="l00102"></a>00102 {
<a name="l00103"></a>00103     setState( );
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">//========================================================================</span>
<a name="l00139"></a><a class="code" href="class_log_normal.html#88d15a97011807ab59ffea30f206ccf8">00139</a> <span class="comment"></span><a class="code" href="class_log_normal.html#185b4fd84954b5e665c8261505e52beb">LogNormal::LogNormal</a>( <span class="keywordtype">double</span> mean, <span class="keywordtype">double</span> variance, <a class="code" href="class_r_n_g.html">RNG</a>&amp; r )
<a name="l00140"></a>00140   : <a class="code" href="class_normal.html">Normal</a>     ( 0, 1, r ),
<a name="l00141"></a>00141     logMean    ( mean ),
<a name="l00142"></a>00142     logVariance( variance )
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144     setState( );
<a name="l00145"></a>00145 }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">// Given a mean value and a variance for the log normal distribution</span>
<a name="l00149"></a>00149 <span class="comment">// this method will prepare the mean value and the standard deviation</span>
<a name="l00150"></a>00150 <span class="comment">// of the inherited normal distribution in a way, that the generation</span>
<a name="l00151"></a>00151 <span class="comment">// of log normally distributed random numbers will take only a single</span>
<a name="l00152"></a>00152 <span class="comment">// simple step (see operator()()).</span>
<a name="l00153"></a>00153 <span class="comment">//</span>
<a name="l00154"></a>00154 <span class="keywordtype">void</span> LogNormal::setState( )
<a name="l00155"></a>00155 {
<a name="l00156"></a>00156     <span class="keywordtype">double</span> m2 = <a class="code" href="class_log_normal.html#e1b1f5cf34efe304a3b8ea5f5c07927a">logMean</a> * <a class="code" href="class_log_normal.html#e1b1f5cf34efe304a3b8ea5f5c07927a">logMean</a>;
<a name="l00157"></a>00157     <a class="code" href="class_normal.html#0b3f96d6bc1fcb410ec0459163c93592">pMean</a>     = log( m2 / sqrt( m2 + <a class="code" href="class_log_normal.html#2fbafbeceddb8e0cd0dfe95be66512dc">logVariance</a> ) );
<a name="l00158"></a>00158     <a class="code" href="class_normal.html#7a9ef250fa4bbf940566a61fee8904eb">pStdDev</a>   = sqrt( log( ( m2 + <a class="code" href="class_log_normal.html#2fbafbeceddb8e0cd0dfe95be66512dc">logVariance</a> ) / m2 ) ); 
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="comment">//========================================================================</span>
<a name="l00181"></a><a class="code" href="class_log_normal.html#6eaebc923e81def0115ac68a50c3c981">00181</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="class_log_normal.html#d8b43d06c94db68c89a1a75b65ec50d5">LogNormal::mean</a>( <span class="keywordtype">double</span> newMean )
<a name="l00182"></a>00182 {
<a name="l00183"></a>00183     logMean = newMean;
<a name="l00184"></a>00184     setState( );
<a name="l00185"></a>00185 }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">//========================================================================</span>
<a name="l00210"></a><a class="code" href="class_log_normal.html#07bfd860f35a7c940811564acfeb7f39">00210</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="class_log_normal.html#594fc1b2139e6155ec5ea21169fc0362">LogNormal::variance</a>( <span class="keywordtype">double</span> newVariance )
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212     <a class="code" href="class_log_normal.html#2fbafbeceddb8e0cd0dfe95be66512dc">logVariance</a> = newVariance;
<a name="l00213"></a>00213     setState( );
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">//========================================================================</span>
<a name="l00241"></a><a class="code" href="class_log_normal.html#23c4f82e41aa47bf8d0a74c2c1bc4062">00241</a> <span class="comment"></span><span class="keywordtype">double</span> LogNormal::operator( )( )
<a name="l00242"></a>00242 {
<a name="l00243"></a>00243     <span class="keywordflow">return</span> exp( Normal::operator( )( ) );
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="comment">//========================================================================</span>
<a name="l00275"></a><a class="code" href="class_log_normal.html#d78889221392bd018f6c76803a476f13">00275</a> <span class="comment"></span><span class="keywordtype">double</span> LogNormal::operator( )( <span class="keywordtype">double</span> mean, <span class="keywordtype">double</span> variance )
<a name="l00276"></a>00276 {
<a name="l00277"></a>00277         <span class="keywordtype">double</span> m2 = mean * mean;
<a name="l00278"></a>00278         <span class="keywordtype">double</span> normMean = log( m2 / sqrt( m2 + variance ) );
<a name="l00279"></a>00279         <span class="keywordtype">double</span> normVariance = sqrt( log( ( m2 + variance ) / m2 ) );
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         <span class="keywordflow">return</span> exp( Normal::operator()(normMean, normVariance));
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">//========================================================================</span>
<a name="l00305"></a><a class="code" href="class_log_normal.html#12c263e70353f1652580fa6391e263ea">00305</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="class_log_normal.html#12c263e70353f1652580fa6391e263ea">LogNormal::p</a>( <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x )<span class="keyword"> const</span>
<a name="l00306"></a>00306 <span class="keyword"></span>{
<a name="l00307"></a>00307     <span class="keywordtype">double</span> y = ( log( x ) - <a class="code" href="class_normal.html#0b3f96d6bc1fcb410ec0459163c93592">pMean</a> ) / <a class="code" href="class_normal.html#7a9ef250fa4bbf940566a61fee8904eb">pStdDev</a>;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     <span class="keywordflow">return</span> x &gt; 0 ? exp( -y*y / 2 ) / ( znSqrtPi2C * <a class="code" href="class_normal.html#7a9ef250fa4bbf940566a61fee8904eb">pStdDev</a> * x ) : 0;
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:06:31 2009 for Rng by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
