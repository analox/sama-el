<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: CrossEntropyIndependent Class Reference</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>CrossEntropyIndependent Class Reference</h1><!-- doxytag: class="CrossEntropyIndependent" --><!-- doxytag: inherits="ModelInterface" -->Error measure for classification tasks of non exclusive attributes that can be used for model training.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_cross_entropy_independent_8h-source.html">CrossEntropyIndependent.h</a>&gt;</code>
<p>
<p>Inheritance diagram for CrossEntropyIndependent:
<p><center><img src="class_cross_entropy_independent.png" usemap="#CrossEntropyIndependent_map" border="0" alt=""></center>
<map name="CrossEntropyIndependent_map">
<area href="class_model_interface.html" alt="ModelInterface" shape="rect" coords="0,0,158,24">
</map>
<a href="class_cross_entropy_independent-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cross_entropy_independent.html#5cfa04f1eeb261776acdfa6110554ceb">error</a> (const Array&lt; double &gt; &amp;<a class="el" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, const Array&lt; double &gt; &amp;target)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error.  <a href="#5cfa04f1eeb261776acdfa6110554ceb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cross_entropy_independent.html#cf4c3b31a0ae1fc28bf8c9652e887fda">derror</a> (const Array&lt; double &gt; &amp;<a class="el" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, const Array&lt; double &gt; &amp;target, bool returnError=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates the derivatives of the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error (see <a class="el" href="class_cross_entropy_independent.html#5cfa04f1eeb261776acdfa6110554ceb">error</a>) with respect to the parameters <a class="el" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">ModelInterface::w</a>.  <a href="#cf4c3b31a0ae1fc28bf8c9652e887fda"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Error measure for classification tasks of non exclusive attributes that can be used for model training. 
<p>
If your model should return a vector whose components are connected to multiple mutually independent attributes and the <em>k-th</em> component of the output vector is representing the probability of the presence of the <em>k-th</em> attribute given any input vector, 'CrossEntropyIndependent' is the adequate error measure for model-training. For <em>C&gt;1</em>, dimension of model's output and every output dimension represents a single attribute or class respectively, it follows the formular <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \sum_{k=1}^{C} \{tar^i_k \ln model_k(in^i) + (1-tar^i_k) \ln (1-model_k(in^i))\} \]" src="form_130.png">
<p>
 where <em>i</em> runs over all input patterns. This error functional can be derivated and so used for training. In case of only one single output dimension 'CrossEntropyIndependent' returns actually the true cross entropy for two classes, using the formalism <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \{tar^i \ln model(in^i) + (1-tar^i) \ln (1-model(in^i))\} \]" src="form_131.png">
<p>
 For theoretical reasons it is suggested to use for neural networks the logistic sigmoid activation function at the output neurons. However, actually every sigmoid activation could be applied to the output neurons as far as the image of this function is identical to the intervall <em></em>[0,1]. In this implementation every target value to be chosen from {0,1} (binary encoding). For detailed information refer to (C.M. Bishop, Neural Networks for Pattern Recognition, Clarendon Press 1996, Chapter 6.8.)<p>
This implementation of the cross entropy performs less efficient than the implemetation given in 'DF_CrossEntropyIndependent.h' for more than one output dimensions, if standard model classes as 'FFNet' are simultaneously linked, because redundant calculations of the outer derivatives are not circumvented.<p>
<dl compact><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes:</b></dt><dd>Revision 2003/06/03 (S. Wiegand): bugs in formulars corrected</dd></dl>
<dl compact><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>

<p>
Definition at line <a class="el" href="_cross_entropy_independent_8h-source.html#l00151">151</a> of file <a class="el" href="_cross_entropy_independent_8h-source.html">CrossEntropyIndependent.h</a>.<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="cf4c3b31a0ae1fc28bf8c9652e887fda"></a><!-- doxytag: member="CrossEntropyIndependent::derror" ref="cf4c3b31a0ae1fc28bf8c9652e887fda" args="(const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target, bool returnError=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CrossEntropyIndependent::derror           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>returnError</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the derivatives of the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error (see <a class="el" href="class_cross_entropy_independent.html#5cfa04f1eeb261776acdfa6110554ceb">error</a>) with respect to the parameters <a class="el" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">ModelInterface::w</a>. 
<p>
Calculates the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error derivative for <em>N</em> patterns and <em>C&gt;1</em> independent attributes within the output vector corresponding to model parameter <em>w</em> via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial w} = - \sum_{i=1}^N \sum_{k=1}^{C} \left\{ \frac{tar^i_k - model_k(in^i)}{model_k(in^i)\cdot(1-model_k(in^i))} \cdot\frac{\partial model_k(in^i)}{\partial w}\right\} \]" src="form_132.png">
<p>
 or the derivative of the true cross entropy for only one single output dimension via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial w} = - \sum_{i=1}^N \left\{ \frac{tar^i - model(in^i)}{model(in^i)\cdot(1-model(in^i))} \cdot\frac{\partial model(in^i)}{\partial w}\right\} \]" src="form_129.png">
<p>
 Usually, as a byproduct of the calculation of the derivative one gets the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error itself very efficiently. Therefore, the method <a class="el" href="class_cross_entropy_independent.html#5cfa04f1eeb261776acdfa6110554ceb">error</a> gives back this value. This additional effect can be switched of by means of the third parameter (returnError = false).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Input vector for the model. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target</em>&nbsp;</td><td>Target vector. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>returnError</em>&nbsp;</td><td>Determines whether or not to calculate the cross entropy error itself. By default the error is calculated. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error if <em>returnError</em> is set to "true", "-1" otherwise.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>Revision 2003/06/03 (S. Wiegand): bugs in formulars corrected</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Reimplemented from <a class="el" href="class_model_interface.html#027f3b43e09f37f614ee56c4ebf8a2ae">ModelInterface</a>.
<p>
Definition at line <a class="el" href="_cross_entropy_independent_8h-source.html#l00279">279</a> of file <a class="el" href="_cross_entropy_independent_8h-source.html">CrossEntropyIndependent.h</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00221">ModelInterface::dedw</a>, <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>, <a class="el" href="_model_interface_8h-source.html#l00387">ModelInterface::dmodel()</a>, and <a class="el" href="_model_interface_8h-source.html#l00228">ModelInterface::outputDimension</a>.
</div>
</div><p>
<a class="anchor" name="5cfa04f1eeb261776acdfa6110554ceb"></a><!-- doxytag: member="CrossEntropyIndependent::error" ref="5cfa04f1eeb261776acdfa6110554ceb" args="(const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CrossEntropyIndependent::error           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>target</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error. 
<p>
Calculates the <a class="el" href="class_cross_entropy_independent.html">CrossEntropyIndependent</a> error function for <em>N</em> patterns and <em>C&gt;1</em> independent attributes within the output vector via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \sum_{k=1}^{C} \{tar^i_k \ln model_k(in^i) + (1-tar^i_k) \ln (1-model_k(in^i))\} \]" src="form_130.png">
<p>
 or the true cross entropy for only one single output dimension via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \{tar^i \ln model(in^i) + (1-tar^i) \ln (1-model(in^i))\} \]" src="form_131.png">
<p>
 <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Input vector for the model. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target</em>&nbsp;</td><td>Target vector. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The error <em>E</em>.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>Revision 2003/06/03 (S. Wiegand): bugs in formulars corrected</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Implements <a class="el" href="class_model_interface.html#adc756409ac6ceabb9bba3061c447fdd">ModelInterface</a>.
<p>
Definition at line <a class="el" href="_cross_entropy_independent_8h-source.html#l00188">188</a> of file <a class="el" href="_cross_entropy_independent_8h-source.html">CrossEntropyIndependent.h</a>.
<p>
References <a class="el" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">ModelInterface::model()</a>, and <a class="el" href="_model_interface_8h-source.html#l00228">ModelInterface::outputDimension</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_cross_entropy_independent_8h-source.html">CrossEntropyIndependent.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:16 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
