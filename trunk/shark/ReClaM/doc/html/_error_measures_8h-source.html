<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: ErrorMeasures.h Source File</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>ErrorMeasures.h</h1><a href="_error_measures_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00073"></a>00073 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="preprocessor">#ifndef ERROR_MEASURES_H</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor">#define ERROR_MEASURES_H</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span>
<a name="l00078"></a>00078 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="preprocessor">#ifndef __SOLARIS__</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;limits&gt;</span>
<a name="l00082"></a>00082 <span class="preprocessor">#else</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;values.h&gt;</span>
<a name="l00084"></a>00084 <span class="preprocessor">#endif</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 <span class="preprocessor">#include "<a class="code" href="_model_interface_8h.html">ReClaM/ModelInterface.h</a>"</span>
<a name="l00087"></a>00087 <span class="preprocessor">#include "Array/ArrayOp.h"</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="comment">//===========================================================================</span>
<a name="l00106"></a><a class="code" href="class_error_measures.html">00106</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_error_measures.html">ErrorMeasures</a> : <span class="keyword">virtual</span> <span class="keyword">public</span> <a class="code" href="class_model_interface.html">ModelInterface</a> {
<a name="l00107"></a>00107  <span class="keyword">public</span>:
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">//===========================================================================</span>
<a name="l00139"></a><a class="code" href="class_error_measures.html#fd29c36884774c7128fd974ac0654d0f">00139</a> <span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="class_error_measures.html#fd29c36884774c7128fd974ac0654d0f">errorPercentage</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>) 
<a name="l00140"></a>00140 {
<a name="l00141"></a>00141     <span class="keywordtype">double</span> se = 0;
<a name="l00142"></a>00142 <span class="preprocessor">#ifndef __SOLARIS__</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>    <span class="keywordtype">double</span> outmax = std::numeric_limits&lt; double &gt;::min( );
<a name="l00144"></a>00144     <span class="keywordtype">double</span> outmin = std::numeric_limits&lt; double &gt;::max( );
<a name="l00145"></a>00145 <span class="preprocessor">#else</span>
<a name="l00146"></a>00146 <span class="preprocessor"></span>    <span class="keywordtype">double</span> outmax = -MAXDOUBLE;
<a name="l00147"></a>00147     <span class="keywordtype">double</span> outmin = MAXDOUBLE;
<a name="l00148"></a>00148 <span class="preprocessor">#endif</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(in.ndim() == 1) {
<a name="l00150"></a>00150       Array&lt;double&gt; output(out.dim(0));
<a name="l00151"></a>00151       <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in, output);
<a name="l00152"></a>00152       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; out.dim(0); c++) {
<a name="l00153"></a>00153         <span class="keywordflow">if</span>(<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(c) &gt; outmax) outmax = <a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(c);
<a name="l00154"></a>00154         <span class="keywordflow">if</span>(<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(c) &lt; outmin) outmin = <a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(c);
<a name="l00155"></a>00155         se += (<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(c) - output(c)) * (<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(c) - output(c));
<a name="l00156"></a>00156       }
<a name="l00157"></a>00157     } <span class="keywordflow">else</span> {
<a name="l00158"></a>00158       Array&lt;double&gt; output(out.dim(1));
<a name="l00159"></a>00159       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> pattern = 0; pattern &lt; in.dim(0); ++pattern) {
<a name="l00160"></a>00160         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in[pattern], output);
<a name="l00161"></a>00161         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; out.dim(1); c++) {
<a name="l00162"></a>00162           <span class="keywordflow">if</span>(<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(pattern, c) &gt; outmax) outmax = <a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(pattern, c);
<a name="l00163"></a>00163           <span class="keywordflow">if</span>(<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(pattern, c) &lt; outmin) outmin = <a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(pattern, c);
<a name="l00164"></a>00164           se += (<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(pattern, c) - output(c)) * (<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>(pattern, c) - output(c));
<a name="l00165"></a>00165         }
<a name="l00166"></a>00166       }
<a name="l00167"></a>00167       se /= in.dim(0);
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169     <span class="keywordflow">return</span> 100 * se / (<a class="code" href="class_model_interface.html#77984c772261c5b4a36c36dffd4a57f4">outputDimension</a> * (outmax - outmin) * (outmax - outmin)) ;
<a name="l00170"></a>00170   }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 <span class="comment">//===========================================================================</span>
<a name="l00204"></a><a class="code" href="class_error_measures.html#fd39741ddf3f1326cf7d17b78d0fb3fb">00204</a> <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="class_error_measures.html#fd39741ddf3f1326cf7d17b78d0fb3fb">meanSquaredError</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, <span class="keyword">const</span> Array&lt;double&gt; &amp;target) 
<a name="l00205"></a>00205   {
<a name="l00206"></a>00206     <span class="keywordflow">return</span> <a class="code" href="class_error_measures.html#e5db3650b5e9a91773d1819145040b76">squaredError</a>(input, target) / target.nelem(); 
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">//===========================================================================</span>
<a name="l00235"></a><a class="code" href="class_error_measures.html#e5db3650b5e9a91773d1819145040b76">00235</a> <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="class_error_measures.html#e5db3650b5e9a91773d1819145040b76">squaredError</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, <span class="keyword">const</span> Array&lt;double&gt; &amp;target) {
<a name="l00236"></a>00236     <span class="keywordtype">double</span> se = 0;
<a name="l00237"></a>00237     <span class="keywordflow">if</span>(input.ndim() == 1) {
<a name="l00238"></a>00238       Array&lt;double&gt; output(target.dim(0));
<a name="l00239"></a>00239       <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(input, output);
<a name="l00240"></a>00240       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; target.dim(0); c++) {
<a name="l00241"></a>00241         se += (target(c) - output(c)) * (target(c) - output(c));
<a name="l00242"></a>00242       }
<a name="l00243"></a>00243     } <span class="keywordflow">else</span> {
<a name="l00244"></a>00244       Array&lt;double&gt; output(target.dim(1));
<a name="l00245"></a>00245       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> pattern = 0; pattern &lt; input.dim(0); ++pattern) {
<a name="l00246"></a>00246         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(input[pattern], output);
<a name="l00247"></a>00247         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; target.dim(1); c++) {
<a name="l00248"></a>00248           se += (target(pattern, c) - output(c)) * (target(pattern, c) - output(c));
<a name="l00249"></a>00249         }
<a name="l00250"></a>00250       }
<a name="l00251"></a>00251     }
<a name="l00252"></a>00252     <span class="keywordflow">return</span> se;
<a name="l00253"></a>00253   }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="comment">//===========================================================================</span>
<a name="l00286"></a><a class="code" href="class_error_measures.html#314dacb181e7e7ebc339cd37c4089702">00286</a> <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="class_error_measures.html#314dacb181e7e7ebc339cd37c4089702">variance</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;data, Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#e9ef92f25cf31ee79e03f1a9d1108609">v</a>) {
<a name="l00287"></a>00287     Array&lt; double &gt; m;
<a name="l00288"></a>00288     m.resize(data.dim(1));
<a name="l00289"></a>00289     v.resize(data.dim(1));
<a name="l00290"></a>00290     m = 0.;
<a name="l00291"></a>00291     v = 0.;
<a name="l00292"></a>00292     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; data.dim(0); ++i ) {
<a name="l00293"></a>00293       m += data[i];
<a name="l00294"></a>00294       v += data[i] * data[i];
<a name="l00295"></a>00295     }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     m /= double(data.dim(0));
<a name="l00298"></a>00298     v /= double(data.dim(0));
<a name="l00299"></a>00299     v -= m * m;
<a name="l00300"></a>00300   }    
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="comment">//===========================================================================</span>
<a name="l00327"></a><a class="code" href="class_error_measures.html#7bf0f698db6429d066bade33c89cf588">00327</a> <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="class_error_measures.html#7bf0f698db6429d066bade33c89cf588">wta</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>) {
<a name="l00328"></a>00328     <span class="keywordtype">double</span> ce = 0;
<a name="l00329"></a>00329     <span class="keywordflow">if</span>(in.ndim() == 1) {
<a name="l00330"></a>00330       Array&lt;double&gt; output(out.dim(0));
<a name="l00331"></a>00331       <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in, output);
<a name="l00332"></a>00332       <a class="code" href="class_error_measures.html#3546f22f5c4fded3c26f4cbe45ed328b">takeAll</a>(output);
<a name="l00333"></a>00333       <span class="keywordflow">if</span>(out != output) ce++;
<a name="l00334"></a>00334     } <span class="keywordflow">else</span> {
<a name="l00335"></a>00335       Array&lt;double&gt; output(out.dim(1));
<a name="l00336"></a>00336       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> pattern = 0; pattern &lt; in.dim(0); ++pattern) {
<a name="l00337"></a>00337         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in[pattern], output);
<a name="l00338"></a>00338         <a class="code" href="class_error_measures.html#3546f22f5c4fded3c26f4cbe45ed328b">takeAll</a>(output);
<a name="l00339"></a>00339         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; output.nelem(); i++) {
<a name="l00340"></a>00340           <span class="keywordflow">if</span>(out[pattern](i) != output(i)) {
<a name="l00341"></a>00341             ce++;
<a name="l00342"></a>00342             <span class="keywordflow">break</span>;
<a name="l00343"></a>00343           }
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345       }
<a name="l00346"></a>00346       ce /= in.dim(0);
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348     <span class="keywordflow">return</span> ce;
<a name="l00349"></a>00349   }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="comment">//===========================================================================</span>
<a name="l00459"></a><a class="code" href="class_error_measures.html#c2231a77be3c98ca51501d154c1407e9">00459</a> <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="class_error_measures.html#c2231a77be3c98ca51501d154c1407e9">binaryCriterion</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#f8434108d670ecbc17d19b1540344c25">out</a>, <span class="keywordtype">double</span> t = 0.) {
<a name="l00460"></a>00460     <span class="keywordtype">double</span> ce = 0;
<a name="l00461"></a>00461     
<a name="l00462"></a>00462     Array&lt;double &gt; o = out;
<a name="l00463"></a>00463     <a class="code" href="class_error_measures.html#a62d7cdd5f23f841ccec5e7fabc5239a">binary</a>(o, 0);
<a name="l00464"></a>00464 
<a name="l00465"></a>00465     <span class="keywordflow">if</span>(in.ndim() == 1) {
<a name="l00466"></a>00466       Array&lt;double&gt; output(out.dim(0));
<a name="l00467"></a>00467       <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in, output);
<a name="l00468"></a>00468       <a class="code" href="class_error_measures.html#a62d7cdd5f23f841ccec5e7fabc5239a">binary</a>(output, t);
<a name="l00469"></a>00469       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; output.nelem(); i++) {
<a name="l00470"></a>00470         <span class="keywordflow">if</span>(o(i) != output(i)) {
<a name="l00471"></a>00471           ce++;
<a name="l00472"></a>00472           <span class="keywordflow">break</span>;
<a name="l00473"></a>00473         }
<a name="l00474"></a>00474       }
<a name="l00475"></a>00475     } <span class="keywordflow">else</span> {
<a name="l00476"></a>00476       Array&lt;double&gt; output(out.dim(1));
<a name="l00477"></a>00477       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> pattern = 0; pattern &lt; in.dim(0); ++pattern) {
<a name="l00478"></a>00478         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in[pattern], output);
<a name="l00479"></a>00479         <a class="code" href="class_error_measures.html#a62d7cdd5f23f841ccec5e7fabc5239a">binary</a>(output, t);
<a name="l00480"></a>00480         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; output.nelem(); i++) {
<a name="l00481"></a>00481           <span class="keywordflow">if</span>(o[pattern](i) != output(i)) {
<a name="l00482"></a>00482             ce++;
<a name="l00483"></a>00483             <span class="keywordflow">break</span>;
<a name="l00484"></a>00484           }
<a name="l00485"></a>00485         }
<a name="l00486"></a>00486       }
<a name="l00487"></a>00487       ce /= (double) in.dim(0);
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489     <span class="keywordflow">return</span> ce;
<a name="l00490"></a>00490   }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="comment">//===========================================================================</span>
<a name="l00523"></a><a class="code" href="class_error_measures.html#3909346bc5ab665bfee9fb3cb9847184">00523</a> <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="class_error_measures.html#3909346bc5ab665bfee9fb3cb9847184">crossEntropy</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;target) {
<a name="l00524"></a>00524     <span class="keyword">const</span> <span class="keywordtype">double</span> minLog=-730; <span class="comment">// variable is only used to circumvent numerical problems with log(.)</span>
<a name="l00525"></a>00525      <span class="keywordtype">double</span> ce=0;
<a name="l00526"></a>00526     <span class="keywordtype">double</span> smaxsum;
<a name="l00527"></a>00527     <span class="keywordflow">if</span> (<a class="code" href="class_model_interface.html#77984c772261c5b4a36c36dffd4a57f4">outputDimension</a>&gt;1)
<a name="l00528"></a>00528       <span class="comment">// more then one output neuron</span>
<a name="l00529"></a>00529       <span class="keywordflow">if</span>(in.ndim() == 1) {
<a name="l00530"></a>00530         Array&lt;double&gt; output(target.dim(0));
<a name="l00531"></a>00531         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in, output);
<a name="l00532"></a>00532         smaxsum=smaxnorm(output);
<a name="l00533"></a>00533         output/=smaxsum;
<a name="l00534"></a>00534         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; target.dim(0); c++)
<a name="l00535"></a>00535           <span class="keywordflow">if</span>(target(c) != 0) 
<a name="l00536"></a>00536             <span class="keywordflow">if</span>(output(c) != 0.)
<a name="l00537"></a>00537               ce -= target(c) * log( output(c) ) ;
<a name="l00538"></a>00538             <span class="keywordflow">else</span>
<a name="l00539"></a>00539               ce -= minLog;
<a name="l00540"></a>00540       } <span class="keywordflow">else</span> {
<a name="l00541"></a>00541         Array&lt;double&gt; output(target.dim(1));
<a name="l00542"></a>00542         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> pattern = 0; pattern &lt; in.dim(0); ++pattern) {
<a name="l00543"></a>00543           <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in[pattern], output); 
<a name="l00544"></a>00544 <span class="comment">//        cout &lt;&lt; endl;</span>
<a name="l00545"></a>00545 <span class="comment">//        writeArray(output,cout);</span>
<a name="l00546"></a>00546           smaxsum=smaxnorm(output);
<a name="l00547"></a>00547 <span class="comment">//        cout &lt;&lt; "Maxsum " &lt;&lt; smaxsum &lt;&lt; endl;</span>
<a name="l00548"></a>00548           output/=smaxsum;
<a name="l00549"></a>00549 <span class="comment">//        writeArray(output,cout);</span>
<a name="l00550"></a>00550           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; target.dim(1); c++)
<a name="l00551"></a>00551             <span class="keywordflow">if</span>(target(pattern, c) != 0)
<a name="l00552"></a>00552               <span class="keywordflow">if</span>(output(c) != 0.) 
<a name="l00553"></a>00553                 ce -= target(pattern, c) * log( output(c) );
<a name="l00554"></a>00554               <span class="keywordflow">else</span>
<a name="l00555"></a>00555                 ce -= minLog;   
<a name="l00556"></a>00556         }
<a name="l00557"></a>00557       }
<a name="l00558"></a>00558     <span class="keywordflow">else</span>{
<a name="l00559"></a>00559       <span class="comment">// only one output neuron</span>
<a name="l00560"></a>00560       <span class="keywordflow">if</span>(in.ndim() == 1) {
<a name="l00561"></a>00561         <span class="comment">// one pattern</span>
<a name="l00562"></a>00562         Array&lt;double&gt; output(1);
<a name="l00563"></a>00563         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in, output);
<a name="l00564"></a>00564         <span class="keywordflow">if</span> ((output(0)!=0) &amp;&amp; (1. - output(0)!=0))
<a name="l00565"></a>00565           ce -= (target(0)*log(output(0)) + (1. - target(0)) * log(1. - output(0)));
<a name="l00566"></a>00566         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (output(0)!=target(0))
<a name="l00567"></a>00567           ce -= minLog;
<a name="l00568"></a>00568       } <span class="keywordflow">else</span> {
<a name="l00569"></a>00569         <span class="comment">// more then one pattern</span>
<a name="l00570"></a>00570         Array&lt;double&gt; output(1);
<a name="l00571"></a>00571         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> pattern = 0; pattern &lt; in.dim(0); ++pattern) {
<a name="l00572"></a>00572           <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(in[pattern], output);
<a name="l00573"></a>00573           <span class="keywordflow">if</span> ((output(0) != 0) &amp;&amp; (1. - output(0)!=0))
<a name="l00574"></a>00574             ce -= target(pattern, 0) * log(output(0)) + (1. - target(pattern, 0)) * log(1. - output(0));
<a name="l00575"></a>00575           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (output(0) != target(pattern, 0))
<a name="l00576"></a>00576             ce -= minLog;         
<a name="l00577"></a>00577         }
<a name="l00578"></a>00578       }
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580     <span class="keywordflow">return</span> ce;
<a name="l00581"></a>00581   }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583  <span class="keyword">private</span>:
<a name="l00584"></a>00584 
<a name="l00585"></a>00585   <span class="keywordtype">double</span> smaxnorm(Array&lt;double&gt; &amp;output) {  
<a name="l00586"></a>00586     <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span> maxexp=1e300;
<a name="l00587"></a>00587 
<a name="l00588"></a>00588     <span class="keywordtype">double</span> sum = 0;
<a name="l00589"></a>00589     <span class="keywordflow">if</span>(output.ndim() == 1) {
<a name="l00590"></a>00590       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; output.nelem(); i++) {
<a name="l00591"></a>00591         <span class="keywordflow">if</span>(output(i)&lt;301)
<a name="l00592"></a>00592           output(i)=exp(output(i));
<a name="l00593"></a>00593         <span class="keywordflow">else</span> output(i)=maxexp/output.nelem();
<a name="l00594"></a>00594         sum += output(i);
<a name="l00595"></a>00595       }
<a name="l00596"></a>00596     } <span class="keywordflow">else</span> {
<a name="l00597"></a>00597       exit(1);
<a name="l00598"></a>00598     }
<a name="l00599"></a>00599     <span class="keywordflow">return</span> sum;
<a name="l00600"></a>00600   }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602  <span class="keyword">protected</span>:
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <span class="comment">// First searches for the best (maximum) output value,</span>
<a name="l00605"></a>00605   <span class="comment">// then sets this value to 1 and all others to 0. </span>
<a name="l00606"></a>00606   <span class="comment">//</span>
<a name="l00607"></a><a class="code" href="class_error_measures.html#3546f22f5c4fded3c26f4cbe45ed328b">00607</a>   <span class="keywordtype">void</span> <a class="code" href="class_error_measures.html#3546f22f5c4fded3c26f4cbe45ed328b">takeAll</a>(Array&lt;double&gt; &amp;a) {
<a name="l00608"></a>00608     <span class="keywordtype">unsigned</span> i, bestIndex = 0;
<a name="l00609"></a>00609     <span class="keywordtype">double</span> best = a(bestIndex);
<a name="l00610"></a>00610     <span class="keywordflow">for</span>(i = 1; i &lt; a.nelem(); i++) {
<a name="l00611"></a>00611       <span class="keywordflow">if</span>(a(i) &gt; best) {
<a name="l00612"></a>00612         bestIndex = i;
<a name="l00613"></a>00613         best = a(bestIndex);
<a name="l00614"></a>00614       }
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616     <span class="keywordflow">for</span>(i = 0; i &lt; a.nelem(); i++) {
<a name="l00617"></a>00617       <span class="keywordflow">if</span>(i == bestIndex) a(i) = 1.;
<a name="l00618"></a>00618       <span class="keywordflow">else</span> a(i) = 0.;
<a name="l00619"></a>00619     }
<a name="l00620"></a>00620   }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622   <span class="comment">// Used to mark output neurons as set/unset.</span>
<a name="l00623"></a>00623   <span class="comment">// Normally the threshold for a neuron to be</span>
<a name="l00624"></a>00624   <span class="comment">// set is 0.5 and higher, but with parameter t</span>
<a name="l00625"></a>00625   <span class="comment">// a buffer interval between set and unset neurons</span>
<a name="l00626"></a>00626   <span class="comment">// is defined. All neurons lying in this interval</span>
<a name="l00627"></a>00627   <span class="comment">// are ignored.</span>
<a name="l00628"></a>00628   <span class="comment">// </span>
<a name="l00629"></a><a class="code" href="class_error_measures.html#a62d7cdd5f23f841ccec5e7fabc5239a">00629</a>   <span class="keywordtype">void</span> <a class="code" href="class_error_measures.html#a62d7cdd5f23f841ccec5e7fabc5239a">binary</a>(Array&lt;double&gt; &amp;a, <span class="keywordtype">double</span> t) {
<a name="l00630"></a>00630     <span class="keywordflow">if</span> (a.ndim()==1)
<a name="l00631"></a>00631       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; a.nelem(); i++) {
<a name="l00632"></a>00632         <span class="keywordflow">if</span>(a(i) &gt; (0.5 + t)) a(i) = 1.;
<a name="l00633"></a>00633         <span class="keywordflow">if</span>(a(i) &lt;= (0.5 - t)) a(i) = 0.;
<a name="l00634"></a>00634       }
<a name="l00635"></a>00635     <span class="keywordflow">else</span>
<a name="l00636"></a>00636       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; a.dim(0); i++)
<a name="l00637"></a>00637         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j&lt;a.dim(1); j++){
<a name="l00638"></a>00638           <span class="keywordflow">if</span>(a(i,j) &gt; (0.5 + t)) a(i,j) = 1.;
<a name="l00639"></a>00639           <span class="keywordflow">if</span>(a(i,j) &lt;= (0.5 - t)) a(i,j) = 0.;
<a name="l00640"></a>00640         }
<a name="l00641"></a>00641   }
<a name="l00642"></a>00642 };
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 <span class="preprocessor">#endif</span>
<a name="l00645"></a>00645 <span class="preprocessor"></span>
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:16 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
