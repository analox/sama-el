<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: ModelInterface.h Source File</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>ModelInterface.h</h1><a href="_model_interface_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef _NEW_RECLAM_VERSION_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="comment">//===========================================================================</span>
<a name="l00087"></a>00087 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="preprocessor">#ifndef MODEL_INTERFACE_H </span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#define MODEL_INTERFACE_H </span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>
<a name="l00092"></a>00092 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00093"></a>00093 <span class="preprocessor">#include "Array/ArrayIo.h"</span>
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="comment">//===========================================================================</span>
<a name="l00118"></a><a class="code" href="class_model_interface.html">00118</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_model_interface.html">ModelInterface</a>{
<a name="l00119"></a>00119         <span class="keyword">public</span>:
<a name="l00120"></a>00120   
<a name="l00121"></a>00121 <span class="comment">//===========================================================================</span>
<a name="l00138"></a><a class="code" href="class_model_interface.html#5a2a626b5bb884a259336f73f4279fe8">00138</a> <span class="comment"></span>                                           <a class="code" href="class_model_interface.html#5a2a626b5bb884a259336f73f4279fe8">ModelInterface</a>(<span class="keywordtype">double</span> e = 1e-8) : <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a>(e) 
<a name="l00139"></a>00139                            {
<a name="l00140"></a>00140                            };
<a name="l00141"></a>00141 
<a name="l00142"></a>00142 <span class="comment">//===========================================================================</span>
<a name="l00170"></a><a class="code" href="class_model_interface.html#492e330ddfc7b134b203f109a516240a">00170</a> <span class="comment"></span>                                                                  <span class="keyword">virtual</span> <a class="code" href="class_model_interface.html#492e330ddfc7b134b203f109a516240a">~ModelInterface</a>() 
<a name="l00171"></a>00171                                                   {
<a name="l00172"></a>00172                                                   };
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="comment">//===========================================================================</span>
<a name="l00196"></a><a class="code" href="class_model_interface.html#28f81635fcd8c8948e512a53c0fac860">00196</a> <span class="comment"></span>                                                                                         <span class="keywordtype">void</span> <a class="code" href="class_model_interface.html#28f81635fcd8c8948e512a53c0fac860">setEpsilon</a> (<span class="keywordtype">double</span> e) 
<a name="l00197"></a>00197                                                                          { 
<a name="l00198"></a>00198                                                                                  <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a> = e; 
<a name="l00199"></a><a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">00199</a>                                                                          };
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 
<a name="l00202"></a>00202                                                                          <span class="comment">//</span>
<a name="l00203"></a>00203   <span class="comment">// Interface variables</span>
<a name="l00204"></a>00204                                                                          <span class="comment">//</span>
<a name="l00205"></a>00205  
<a name="l00206"></a>00206         <span class="keyword">protected</span>:
<a name="l00211"></a>00211                 Array&lt;double&gt; <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>;
<a name="l00212"></a>00212 
<a name="l00216"></a><a class="code" href="class_model_interface.html#0c413b9de11d456b34886695aba46132">00216</a>                 Array&lt;double&gt; <a class="code" href="class_model_interface.html#0c413b9de11d456b34886695aba46132">dmdw</a>; 
<a name="l00217"></a>00217 
<a name="l00221"></a><a class="code" href="class_model_interface.html#8ef52ebca3fbb98f2b4acf3a04426189">00221</a>                 Array&lt;double&gt; <a class="code" href="class_model_interface.html#8ef52ebca3fbb98f2b4acf3a04426189">dedw</a>;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="keyword">public</span>:
<a name="l00225"></a><a class="code" href="class_model_interface.html#7e62617026dd0f5caf6b52c867090477">00225</a>                 <span class="keywordtype">unsigned</span>      <a class="code" href="class_model_interface.html#7e62617026dd0f5caf6b52c867090477">inputDimension</a>;
<a name="l00226"></a>00226 
<a name="l00228"></a><a class="code" href="class_model_interface.html#77984c772261c5b4a36c36dffd4a57f4">00228</a>                 <span class="keywordtype">unsigned</span>      <a class="code" href="class_model_interface.html#77984c772261c5b4a36c36dffd4a57f4">outputDimension</a>;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="comment">//===========================================================================</span>
<a name="l00254"></a>00254 <span class="comment"></span>                                                   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="class_model_interface.html#adc756409ac6ceabb9bba3061c447fdd">error</a>   (<span class="keyword">const</span> Array&lt;double&gt; &amp;input, <span class="keyword">const</span> Array&lt;double&gt; &amp;target) = 0;
<a name="l00255"></a>00255   
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">//===========================================================================</span>
<a name="l00302"></a><a class="code" href="class_model_interface.html#027f3b43e09f37f614ee56c4ebf8a2ae">00302</a> <span class="comment"></span>                                                                          <span class="keyword">virtual</span> <span class="keywordtype">double</span>   <a class="code" href="class_model_interface.html#027f3b43e09f37f614ee56c4ebf8a2ae">derror</a>  (<span class="keyword">const</span> Array&lt;double&gt; &amp;input, <span class="keyword">const</span> Array&lt;double&gt; &amp;target,
<a name="l00303"></a>00303                                                                           <span class="keywordtype">bool</span> returnError = <span class="keyword">true</span>) {
<a name="l00304"></a>00304                                                                                   <span class="keywordtype">double</span> e, eEpsilon, wMem;
<a name="l00305"></a>00305                                                                                   e = <a class="code" href="class_model_interface.html#adc756409ac6ceabb9bba3061c447fdd">error</a>(input, target);
<a name="l00306"></a>00306                                                                                   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>.nelem(); i++) {
<a name="l00307"></a>00307                                                                                           wMem     = <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(i);
<a name="l00308"></a>00308                                                                                           <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(i)    += <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a>;
<a name="l00309"></a>00309                                                                                           eEpsilon = <a class="code" href="class_model_interface.html#adc756409ac6ceabb9bba3061c447fdd">error</a>(input, target);
<a name="l00310"></a>00310                                                                                           <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(i)     = wMem;
<a name="l00311"></a>00311                                                                                           <a class="code" href="class_model_interface.html#8ef52ebca3fbb98f2b4acf3a04426189">dedw</a>(i)    = (eEpsilon - e) /  <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a>;
<a name="l00312"></a>00312                                                                                   }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314                                                                                   <span class="keywordflow">if</span> (!returnError)
<a name="l00315"></a>00315                                                                                           e=-1;
<a name="l00316"></a>00316     
<a name="l00317"></a>00317                                                                                   <span class="keywordflow">return</span> e;  
<a name="l00318"></a>00318                                                                           }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="comment">//===========================================================================</span>
<a name="l00348"></a>00348 <span class="comment"></span>                                                                                                                 <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, Array&lt;double&gt; &amp;output) = 0;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="comment">//===========================================================================</span>
<a name="l00387"></a><a class="code" href="class_model_interface.html#b23edb5a71615a8b8562a95eefaea76b">00387</a> <span class="comment"></span>                                                                                                                                        <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="class_model_interface.html#b23edb5a71615a8b8562a95eefaea76b">dmodel</a>  (<span class="keyword">const</span> Array&lt;double&gt; &amp;input) {
<a name="l00388"></a>00388                                                                                                                                 <span class="keywordtype">double</span> wMem;
<a name="l00389"></a>00389                                                                                                                                 <span class="keywordflow">if</span>(input.ndim() == 1) {
<a name="l00390"></a>00390                                                                                                                                         Array&lt;double&gt; output       (<a class="code" href="class_model_interface.html#77984c772261c5b4a36c36dffd4a57f4">outputDimension</a>);
<a name="l00391"></a>00391                                                                                                                                         Array&lt;double&gt; outputEpsilon(outputDimension);
<a name="l00392"></a>00392                                                                                                                                         <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(input, output);
<a name="l00393"></a>00393                                                                                                                                         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>.nelem(); i++) {
<a name="l00394"></a>00394                                                                                                                                                 wMem     = <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(i);
<a name="l00395"></a>00395                                                                                                                                                 <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(i)    += <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a>;
<a name="l00396"></a>00396                                                                                                                                                 <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a>(input, outputEpsilon);
<a name="l00397"></a>00397                                                                                                                                                 <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(i)     = wMem;
<a name="l00398"></a>00398                                                                                                                                                 <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; outputDimension; c++)
<a name="l00399"></a>00399                                                                                                                                                         <a class="code" href="class_model_interface.html#0c413b9de11d456b34886695aba46132">dmdw</a>(c, i) = (outputEpsilon(c) - output(c)) / <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a>;
<a name="l00400"></a>00400                                                                                                                                         }
<a name="l00401"></a>00401                                                                                                                                 } <span class="keywordflow">else</span> {
<a name="l00402"></a>00402                                                                                                                                         std::cerr &lt;&lt; <span class="stringliteral">"the derivative of the model with respect to more than one input is not defined"</span> &lt;&lt; std::endl;
<a name="l00403"></a>00403                                                                                                                                         exit(EXIT_FAILURE);
<a name="l00404"></a>00404                                                                                                                                 }    
<a name="l00405"></a>00405                                                                                                                                         }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="comment">//===========================================================================</span>
<a name="l00433"></a><a class="code" href="class_model_interface.html#ddf4c9abe64248937899e99ced1a4fdc">00433</a> <span class="comment"></span>                                                                                                                                                                <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="class_model_interface.html#b23edb5a71615a8b8562a95eefaea76b">dmodel</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, Array&lt;double&gt; &amp;output) {
<a name="l00434"></a>00434                                                                                                                                                                 <a class="code" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">model</a> (input, output);
<a name="l00435"></a>00435                                                                                                                                                                 <a class="code" href="class_model_interface.html#b23edb5a71615a8b8562a95eefaea76b">dmodel</a>(input);
<a name="l00436"></a>00436                                                                                                                                                                 }
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         <span class="keyword">protected</span>:
<a name="l00439"></a>00439   
<a name="l00442"></a><a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">00442</a>                 <span class="keywordtype">double</span> <a class="code" href="class_model_interface.html#e334af5c569acfd5b030fb5f5f91ea45">epsilon</a>;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <span class="comment">//===========================================================================</span>
<a name="l00507"></a><a class="code" href="class_model_interface.html#4a6f2e2de39bcb87714e22b5cc01bd9f">00507</a> <span class="comment"></span>                                                   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_model_interface.html#4a6f2e2de39bcb87714e22b5cc01bd9f">df</a>(<span class="keyword">const</span> Array&lt;double&gt; &amp;c, Array&lt;double&gt; &amp;dfdw) 
<a name="l00508"></a>00508                                    { 
<a name="l00509"></a>00509                                            std::cerr &lt;&lt; <span class="stringliteral">"function df(const Array&lt;double&gt; &amp;c, Array&lt;double&gt; &amp;dfdw) "</span>
<a name="l00510"></a>00510                                                            &lt;&lt; <span class="stringliteral">"used but not implemented"</span> &lt;&lt; std::endl;
<a name="l00511"></a>00511                                            exit(EXIT_FAILURE);
<a name="l00512"></a>00512                                    }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 };
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 <span class="preprocessor">#endif</span>
<a name="l00517"></a>00517 <span class="preprocessor"></span>
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 
<a name="l00527"></a>00527 <span class="comment">// ***************** IT FOLLOWS THE REPLACEMENT VERSION</span>
<a name="l00528"></a>00528 <span class="comment">// ***************** FOR THE NEW RECLAM STRUCTURE</span>
<a name="l00529"></a>00529 <span class="comment">// ***************** PROVIDED FOR DOWNWARDS COMPATIBILITY</span>
<a name="l00530"></a>00530 <span class="preprocessor">#else</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span>
<a name="l00532"></a>00532 
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="comment">//===========================================================================</span>
<a name="l00626"></a>00626 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 <span class="preprocessor">#ifndef _ModelInterface_H_</span>
<a name="l00629"></a>00629 <span class="preprocessor"></span><span class="preprocessor">#define _ModelInterface_H_</span>
<a name="l00630"></a>00630 <span class="preprocessor"></span>
<a name="l00631"></a>00631 
<a name="l00632"></a>00632 <span class="preprocessor">#include "<a class="code" href="_model_8h.html">Model.h</a>"</span>
<a name="l00633"></a>00633 <span class="preprocessor">#include "<a class="code" href="_error_function_8h.html">ErrorFunction.h</a>"</span>
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 
<a name="l00646"></a>00646 <span class="keyword">class </span><a class="code" href="class_model_interface.html">ModelInterface</a> : <span class="keyword">public</span> <a class="code" href="class_error_function.html">ErrorFunction</a>, <span class="keyword">public</span> <a class="code" href="class_model.html">Model</a>
<a name="l00647"></a>00647 {
<a name="l00648"></a>00648 <span class="keyword">public</span>:
<a name="l00652"></a>00652         <a class="code" href="class_model_interface.html#5a2a626b5bb884a259336f73f4279fe8">ModelInterface</a>()
<a name="l00653"></a>00653                 : <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>(<a class="code" href="class_model.html">Model</a>::parameter)
<a name="l00654"></a>00654         {
<a name="l00655"></a>00655         }
<a name="l00656"></a>00656 
<a name="l00658"></a>00658         <span class="keyword">virtual</span> <a class="code" href="class_model_interface.html#492e330ddfc7b134b203f109a516240a">~ModelInterface</a>()
<a name="l00659"></a>00659         {
<a name="l00660"></a>00660         }
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 
<a name="l00664"></a>00664         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_model_interface.html#b23edb5a71615a8b8562a95eefaea76b">dmodel</a>(<span class="keyword">const</span> Array&lt;double&gt;&amp; input)
<a name="l00665"></a>00665         {
<a name="l00666"></a>00666                 ((<a class="code" href="class_model.html">Model</a>*)<span class="keyword">this</span>)-&gt;modelDerivative(input, <a class="code" href="class_model_interface.html#0c413b9de11d456b34886695aba46132">dmdw</a>);
<a name="l00667"></a>00667         }
<a name="l00668"></a>00668 
<a name="l00670"></a>00670         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_model_interface.html#b23edb5a71615a8b8562a95eefaea76b">dmodel</a>(<span class="keyword">const</span> Array&lt;double&gt;&amp; input, Array&lt;double&gt;&amp; output)
<a name="l00671"></a>00671         {
<a name="l00672"></a>00672                 ((<a class="code" href="class_model.html">Model</a>*)<span class="keyword">this</span>)-&gt;modelDerivative(input, output, <a class="code" href="class_model_interface.html#0c413b9de11d456b34886695aba46132">dmdw</a>);
<a name="l00673"></a>00673         }
<a name="l00674"></a>00674 
<a name="l00676"></a>00676         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="class_model_interface.html#adc756409ac6ceabb9bba3061c447fdd">error</a>(<span class="keyword">const</span> Array&lt;double&gt;&amp; input, <span class="keyword">const</span> Array&lt;double&gt;&amp; target)
<a name="l00677"></a>00677         {
<a name="l00678"></a>00678                 <span class="keywordflow">return</span> ((<a class="code" href="class_error_function.html">ErrorFunction</a>*)<span class="keyword">this</span>)-&gt;error(*(<a class="code" href="class_model.html">Model</a>*)<span class="keyword">this</span>, input, target);
<a name="l00679"></a>00679         }
<a name="l00680"></a>00680 
<a name="l00682"></a>00682         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="class_model_interface.html#027f3b43e09f37f614ee56c4ebf8a2ae">derror</a>(<span class="keyword">const</span> Array&lt;double&gt;&amp; input, <span class="keyword">const</span> Array&lt;double&gt;&amp; target, <span class="keywordtype">bool</span> bReturnError = <span class="keyword">true</span>)
<a name="l00683"></a>00683         {
<a name="l00684"></a>00684                 <span class="keywordflow">return</span> ((<a class="code" href="class_error_function.html">ErrorFunction</a>*)<span class="keyword">this</span>)-&gt;errorDerivative(*(<a class="code" href="class_model.html">Model</a>*)<span class="keyword">this</span>, input, target, <a class="code" href="class_model_interface.html#8ef52ebca3fbb98f2b4acf3a04426189">dedw</a>);
<a name="l00685"></a>00685         }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 <span class="keyword">protected</span>:
<a name="l00689"></a>00689         Array&lt;double&gt;&amp; <a class="code" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">w</a>;
<a name="l00690"></a>00690 
<a name="l00692"></a>00692         Array&lt;double&gt; <a class="code" href="class_model_interface.html#0c413b9de11d456b34886695aba46132">dmdw</a>;
<a name="l00693"></a>00693 
<a name="l00695"></a>00695         Array&lt;double&gt; <a class="code" href="class_model_interface.html#8ef52ebca3fbb98f2b4acf3a04426189">dedw</a>;
<a name="l00696"></a>00696 };
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="preprocessor">#endif</span>
<a name="l00700"></a>00700 <span class="preprocessor"></span>
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:16 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
