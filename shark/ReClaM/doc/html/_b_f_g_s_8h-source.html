<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: BFGS.h Source File</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>BFGS.h</h1><a href="_b_f_g_s_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00092"></a>00092 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="preprocessor">#ifndef BFGS_H</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="preprocessor">#define BFGS_H</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00098"></a>00098 <span class="preprocessor">#include "<a class="code" href="_model_interface_8h.html">ReClaM/ModelInterface.h</a>"</span>
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">//===========================================================================</span>
<a name="l00149"></a><a class="code" href="class_b_f_g_s.html">00149</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="class_b_f_g_s.html">BFGS</a> : <span class="keyword">virtual</span> <span class="keyword">public</span> <a class="code" href="class_model_interface.html">ModelInterface</a> {
<a name="l00150"></a>00150  <span class="keyword">public</span>:
<a name="l00151"></a>00151 
<a name="l00158"></a><a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd767676">00158</a>    <span class="keyword">enum</span> <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd767676">LineSearch</a> { <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd7676766c4db6f5633b0c3aa7787f613818892f">Dlinmin</a>, <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd767676f06a0f8ee43a21249befce1e88984b91">Linmin</a>, <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd7676760f22d78bfcbdb289c850746ef48b3f37">Cblnsrch</a> };
<a name="l00159"></a>00159 
<a name="l00162"></a>00162    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#28b00dda5968fdeebd8d14c14c1b7f37">bfgs</a>     (<span class="keyword">const</span> Array&lt;double&gt; &amp;i, <span class="keyword">const</span> Array&lt;double&gt; &amp;t, 
<a name="l00163"></a>00163                   <span class="keywordtype">double</span>    gtol,
<a name="l00164"></a>00164                   <span class="keywordtype">unsigned</span>&amp; iter,
<a name="l00165"></a>00165                   <span class="keywordtype">double</span>&amp;   fret,
<a name="l00166"></a>00166                   <span class="keywordtype">unsigned</span>  iterMax);
<a name="l00167"></a>00167 
<a name="l00170"></a>00170    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#01cc3e9935311f64da5a1fcf65781622">initBfgs</a> (<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;target, 
<a name="l00171"></a>00171                   <span class="keywordtype">double</span>&amp;   fret, <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd767676">LineSearch</a> ls = <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd7676766c4db6f5633b0c3aa7787f613818892f">Dlinmin</a>,
<a name="l00172"></a>00172                   <span class="keywordtype">double</span> ax = 0., <span class="keywordtype">double</span> bx = 1., <span class="keywordtype">double</span> lambda = 0.25);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="comment">//===========================================================================</span>
<a name="l00206"></a><a class="code" href="class_b_f_g_s.html#a481a31cfc1a3b762366551efdcb65b5">00206</a> <span class="comment"></span>   <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#01cc3e9935311f64da5a1fcf65781622">initBfgs</a> (<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;target, 
<a name="l00207"></a>00207                   <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd767676">LineSearch</a> ls = <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd7676766c4db6f5633b0c3aa7787f613818892f">Dlinmin</a>,
<a name="l00208"></a>00208                   <span class="keywordtype">double</span> ax = 0., <span class="keywordtype">double</span> bx = 1., <span class="keywordtype">double</span> lambda = 0.25) 
<a name="l00209"></a>00209    {
<a name="l00210"></a>00210        <span class="keywordtype">double</span> fret;
<a name="l00211"></a>00211        <a class="code" href="class_b_f_g_s.html#01cc3e9935311f64da5a1fcf65781622">initBfgs</a>(in, target, fret, ls, ax, bx, lambda);
<a name="l00212"></a>00212    }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 
<a name="l00218"></a>00218    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#28b00dda5968fdeebd8d14c14c1b7f37">bfgs</a>     (<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;target, 
<a name="l00219"></a>00219                   <span class="keywordtype">double</span>&amp; fret);
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="comment">//===========================================================================</span>
<a name="l00248"></a><a class="code" href="class_b_f_g_s.html#fde6c5b2e2ccb8fa4ab99cf1ac7793c3">00248</a> <span class="comment"></span>   <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#28b00dda5968fdeebd8d14c14c1b7f37">bfgs</a>     (<span class="keyword">const</span> Array&lt;double&gt; &amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, <span class="keyword">const</span> Array&lt;double&gt; &amp;target) 
<a name="l00249"></a>00249    {
<a name="l00250"></a>00250        <span class="keywordtype">double</span> fret;
<a name="l00251"></a>00251        <a class="code" href="class_b_f_g_s.html#28b00dda5968fdeebd8d14c14c1b7f37">bfgs</a>(in, target, fret);
<a name="l00252"></a>00252    }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">//===========================================================================</span>
<a name="l00285"></a><a class="code" href="class_b_f_g_s.html#8868635bdf1803958af7efcc6828d7d2">00285</a> <span class="comment"></span>   <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#8868635bdf1803958af7efcc6828d7d2">setAx</a>     (<span class="keywordtype">double</span> x) { LS_ax = x; }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="comment">//===========================================================================</span>
<a name="l00318"></a><a class="code" href="class_b_f_g_s.html#58cacff3b6038f8cd629bdd870f8a48e">00318</a> <span class="comment"></span>   <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#58cacff3b6038f8cd629bdd870f8a48e">setBx</a>     (<span class="keywordtype">double</span> x) { LS_bx = x; }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 <span class="comment">//===========================================================================</span>
<a name="l00351"></a><a class="code" href="class_b_f_g_s.html#41f286789d01d79cbc1ac68d56deea10">00351</a> <span class="comment"></span>   <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#41f286789d01d79cbc1ac68d56deea10">setLambda</a> (<span class="keywordtype">double</span> x) { LS_lambda = x; }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353    <span class="keywordtype">void</span> <a class="code" href="class_b_f_g_s.html#619e51247b0cda5a511026a309f0bce6">reset</a>();
<a name="l00354"></a>00354  <span class="keyword">private</span>:
<a name="l00355"></a>00355 
<a name="l00356"></a>00356    <span class="keywordtype">void</span> dlinmin  (Array&lt; double &gt;&amp; p,
<a name="l00357"></a>00357                   <span class="keyword">const</span> Array&lt; double &gt;&amp; xi,
<a name="l00358"></a>00358                   <span class="keywordtype">double</span>&amp;                fret,
<a name="l00359"></a>00359                   <span class="keyword">const</span> Array&lt; double &gt;&amp; <a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>,
<a name="l00360"></a>00360                   <span class="keyword">const</span> Array&lt; double &gt;&amp; target);
<a name="l00361"></a>00361 
<a name="l00362"></a>00362    <span class="keywordtype">void</span> linmin   (Array&lt; double &gt;&amp; p,
<a name="l00363"></a>00363                   <span class="keyword">const</span> Array&lt; double &gt;&amp; xi,
<a name="l00364"></a>00364                   <span class="keywordtype">double</span>&amp;                fret,
<a name="l00365"></a>00365                   <span class="keyword">const</span> Array&lt; double &gt;&amp; <a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>,
<a name="l00366"></a>00366                   <span class="keyword">const</span> Array&lt; double &gt;&amp; target);
<a name="l00367"></a>00367 
<a name="l00368"></a>00368    <span class="keywordtype">void</span> cblnsrch (Array&lt; double &gt;&amp; xold,
<a name="l00369"></a>00369                   <span class="keywordtype">double</span> fold,           <span class="comment">// evaluation at current solution</span>
<a name="l00370"></a>00370                   Array&lt; double &gt;&amp; g,    <span class="comment">// current gradient</span>
<a name="l00371"></a>00371                   Array&lt; double &gt;&amp; p,    <span class="comment">// search direction</span>
<a name="l00372"></a>00372                   Array&lt; double &gt;&amp; x,    <span class="comment">// returns the new solution</span>
<a name="l00373"></a>00373                   <span class="keywordtype">double</span>&amp; fret,
<a name="l00374"></a>00374                   <span class="keyword">const</span> Array&lt; double &gt;&amp;<a class="code" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>,
<a name="l00375"></a>00375                   <span class="keyword">const</span> Array&lt; double &gt;&amp;target); 
<a name="l00376"></a>00376 
<a name="l00377"></a>00377    <a class="code" href="class_b_f_g_s.html#e5f143fc417c982f31c96b89bd767676">LineSearch</a>    lineSearchType;
<a name="l00378"></a>00378    
<a name="l00379"></a>00379    <span class="keywordtype">double</span>        LS_lambda;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381    <span class="keywordtype">double</span>        LS_ax;
<a name="l00382"></a>00382 
<a name="l00383"></a>00383    <span class="keywordtype">double</span>        LS_bx;
<a name="l00384"></a>00384 
<a name="l00385"></a>00385    <span class="keywordtype">unsigned</span>      BFGS_n;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387    <span class="keywordtype">double</span>        BFGS_d;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389    <span class="keywordtype">double</span>        BFGS_scale;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391    Array&lt;double&gt; BFGS_s;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393    Array&lt;double&gt; BFGS_g0;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395    Array&lt;double&gt; BFGS_g1;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397    Array&lt;double&gt; BFGS_p1;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399    Array&lt;double&gt; BFGS_gamma;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401    Array&lt;double&gt; BFGS_delta;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403    Array&lt;double&gt; BFGS_p;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405    <span class="comment">// the approximated Hessian matrix</span>
<a name="l00406"></a>00406    Array&lt;double&gt; H;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 };
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:16 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
