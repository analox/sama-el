<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>LinAlg: fft.cpp Source File</title>
<link href="LinAlg.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>fft.cpp</h1><a href="fft_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00107"></a>00107 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="preprocessor">#include "<a class="code" href="fft_8h.html">LinAlg/fft.h</a>"</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="comment">//===========================================================================</span>
<a name="l00149"></a><a class="code" href="fft_8h.html#0afbb89eb11a9e8810d6e613a00eaf9b">00149</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="fft_8cpp.html#0afbb89eb11a9e8810d6e613a00eaf9b">fft</a>( Array&lt; std::complex&lt; double &gt; &gt;&amp; data, <span class="keywordtype">int</span> isign )
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151         <span class="keywordtype">int</span>    i1, i2, i3, i2rev, ip1, ip2, ip3, ifp1, ifp2;
<a name="l00152"></a>00152         <span class="keywordtype">int</span>    ibit, idim, k1, k2, n, nprev, nrem;
<a name="l00153"></a>00153         <span class="keywordtype">double</span> theta, wtemp, twopi;
<a name="l00154"></a>00154         std::complex&lt; double &gt; temp, w, wp;
<a name="l00155"></a>00155 
<a name="l00156"></a>00156         twopi = 2.0*znPiC; 
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         nprev = 1;
<a name="l00159"></a>00159  
<a name="l00160"></a>00160         <span class="keywordflow">for</span>( idim = data.ndim( ); idim--; )
<a name="l00161"></a>00161         {
<a name="l00162"></a>00162                 n = data.dim( idim );
<a name="l00163"></a>00163                 nrem = data.nelem( )/(n*nprev);
<a name="l00164"></a>00164                 ip1 = nprev &lt;&lt; 1;
<a name="l00165"></a>00165                 ip2 = ip1*n;
<a name="l00166"></a>00166                 ip3 = ip2*nrem;
<a name="l00167"></a>00167                 i2rev = 1;
<a name="l00168"></a>00168                 <span class="keywordflow">for</span> ( i2 = 1; i2 &lt;= ip2; i2 += ip1) 
<a name="l00169"></a>00169                 {
<a name="l00170"></a>00170                         <span class="keywordflow">if</span> (i2 &lt; i2rev)
<a name="l00171"></a>00171                         {
<a name="l00172"></a>00172                                 <span class="keywordflow">for</span> (i1 = i2; i1 &lt;= i2+ip1-2; i1 += 2)
<a name="l00173"></a>00173                                 {
<a name="l00174"></a>00174                                         <span class="keywordflow">for</span> (i3 = i1-1; i3 &lt; ip3; i3 += ip2)
<a name="l00175"></a>00175                                         {
<a name="l00176"></a>00176                                                 std::swap
<a name="l00177"></a>00177                                                 (
<a name="l00178"></a>00178                                                         data.elem( i3 / 2 ),
<a name="l00179"></a>00179                                                         data.elem( ( i2rev + i3 - i2 ) / 2 )
<a name="l00180"></a>00180                                                 );
<a name="l00181"></a>00181                                         }
<a name="l00182"></a>00182                                 }
<a name="l00183"></a>00183                         }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185                         ibit = ip2 &gt;&gt; 1;
<a name="l00186"></a>00186                         <span class="keywordflow">while</span> ((ibit &gt;= ip1) &amp;&amp; (i2rev &gt; ibit))
<a name="l00187"></a>00187                         {
<a name="l00188"></a>00188                                 i2rev -= ibit;
<a name="l00189"></a>00189                                 ibit &gt;&gt;= 1;
<a name="l00190"></a>00190                         }
<a name="l00191"></a>00191                         i2rev += ibit;
<a name="l00192"></a>00192                 }
<a name="l00193"></a>00193                 ifp1 = ip1;
<a name="l00194"></a>00194                 <span class="keywordflow">while</span> (ifp1 &lt; ip2)
<a name="l00195"></a>00195                 {
<a name="l00196"></a>00196                         ifp2  = ifp1 &lt;&lt; 1;
<a name="l00197"></a>00197                         theta = isign*twopi/(ifp2/ip1);
<a name="l00198"></a>00198                         wtemp = sin(0.5*theta);
<a name="l00199"></a>00199                         wp = std::complex&lt; double &gt;( -2.0*wtemp*wtemp, sin(theta) );
<a name="l00200"></a>00200                         w  = 1;
<a name="l00201"></a>00201                         <span class="keywordflow">for</span> (i3 = 1; i3 &lt;= ifp1; i3 += ip1)
<a name="l00202"></a>00202                         {
<a name="l00203"></a>00203                                 <span class="keywordflow">for</span> (i1 = i3; i1 &lt;= i3+ip1-2; i1 += 2)
<a name="l00204"></a>00204                                 {
<a name="l00205"></a>00205                                         <span class="keywordflow">for</span> (i2 = i1-1; i2 &lt; ip3; i2 += ifp2)
<a name="l00206"></a>00206                                         {
<a name="l00207"></a>00207                                                 k1 = i2 / 2;
<a name="l00208"></a>00208                                                 k2 = k1 + ifp1 / 2;
<a name="l00209"></a>00209                                                 temp = data.elem( k2 ) * w;
<a name="l00210"></a>00210                                                 data.elem( k2 )  = data.elem( k1 ) - temp;
<a name="l00211"></a>00211                                                 data.elem( k1 ) += temp;
<a name="l00212"></a>00212                                         }
<a name="l00213"></a>00213                                 }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215                                 w += w * wp;
<a name="l00216"></a>00216                         }
<a name="l00217"></a>00217                         ifp1 = ifp2;
<a name="l00218"></a>00218                 }
<a name="l00219"></a>00219                 nprev *= n;
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 <span class="comment">//===========================================================================</span>
<a name="l00249"></a><a class="code" href="fft_8h.html#78024ada4213891b1096f8f7a2a3bf5c">00249</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="fft_8cpp.html#78024ada4213891b1096f8f7a2a3bf5c">ifft</a>( Array&lt; std::complex&lt; double &gt; &gt;&amp; data )
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251    <a class="code" href="fft_8cpp.html#0afbb89eb11a9e8810d6e613a00eaf9b">fft</a>( data, 1 );
<a name="l00252"></a>00252    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i = 0; i &lt; data.nelem( ); ++i )
<a name="l00253"></a>00253        data.elem( i ) /= double( data.nelem( ) );
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 <span class="comment">//===========================================================================</span>
<a name="l00284"></a><a class="code" href="fft_8h.html#7c57e606e8d47a9ae84d535c30554e7c">00284</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="fft_8cpp.html#0afbb89eb11a9e8810d6e613a00eaf9b">fft</a>( Array&lt; std::complex&lt; double &gt; &gt;&amp; data )
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286     <a class="code" href="fft_8cpp.html#0afbb89eb11a9e8810d6e613a00eaf9b">fft</a>( data, -1 );
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:06:53 2009 for LinAlg by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
