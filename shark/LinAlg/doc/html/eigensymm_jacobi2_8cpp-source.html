<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>LinAlg: eigensymmJacobi2.cpp Source File</title>
<link href="LinAlg.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>eigensymmJacobi2.cpp</h1><a href="eigensymm_jacobi2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00072"></a>00072 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="preprocessor">#include "ZNconfig.h"</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00076"></a>00076 <span class="preprocessor">#include "<a class="code" href="linalg_8h.html">LinAlg/linalg.h</a>"</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">//===========================================================================</span>
<a name="l00130"></a>00130 <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="eigensymm_jacobi2_8cpp.html#b11a543dec385422cc31d628396e9c7a">eigensymmJacobi2</a>
<a name="l00131"></a><a class="code" href="linalg_8h.html#b11a543dec385422cc31d628396e9c7a">00131</a> (
<a name="l00132"></a>00132         Array2D&lt; double &gt;&amp; amatA,
<a name="l00133"></a>00133         Array2D&lt; double &gt;&amp; vmatA,
<a name="l00134"></a>00134         Array  &lt; double &gt;&amp; dvecA
<a name="l00135"></a>00135 )
<a name="l00136"></a>00136 {
<a name="l00137"></a>00137         SIZE_CHECK( amatA.ndim( ) == 2 &amp;&amp; amatA.dim( 0 ) == amatA.dim( 1 ) )
<a name="l00138"></a>00138 
<a name="l00139"></a>00139         vmatA.resize( amatA );
<a name="l00140"></a>00140         dvecA.resize( amatA.dim( 0 ) );
<a name="l00141"></a>00141 
<a name="l00142"></a>00142         <span class="keywordtype">double</span> **a   = amatA.ptrArr( );
<a name="l00143"></a>00143         <span class="keywordtype">double</span> **vec = vmatA.ptrArr( );
<a name="l00144"></a>00144         <span class="keywordtype">double</span>  *val = dvecA.elemvec( );
<a name="l00145"></a>00145         <span class="keywordtype">unsigned</span> n   = dvecA.nelem( );
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <span class="keywordtype">unsigned</span> ind, i, j, l, m;
<a name="l00148"></a>00148     <span class="keywordtype">double</span> anorm, thr, aml, all, amm, x, y;
<a name="l00149"></a>00149     <span class="keywordtype">double</span> *aim, *ail;
<a name="l00150"></a>00150     <span class="keywordtype">double</span> sinx, sinx2, cosx, cosx2, sincs;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <span class="comment">/*</span>
<a name="l00153"></a>00153 <span class="comment">     * Diagonalelemente von 'a' nach 'val' kopieren,</span>
<a name="l00154"></a>00154 <span class="comment">     * 'val' konvergiert gegen die Eigenwerte</span>
<a name="l00155"></a>00155 <span class="comment">     */</span>
<a name="l00156"></a>00156     <span class="keywordflow">for</span>( j = 0; j &lt; n; j++ )
<a name="l00157"></a>00157         {
<a name="l00158"></a>00158                 val [j] = a [j] [j];
<a name="l00159"></a>00159         }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">/*</span>
<a name="l00162"></a>00162 <span class="comment">     * Einheitsmatrix in 'vec' initialisieren</span>
<a name="l00163"></a>00163 <span class="comment">     * Quadratnorm der Nebendiagonalelemente von 'a' in 'anorm'</span>
<a name="l00164"></a>00164 <span class="comment">     */</span>
<a name="l00165"></a>00165     anorm = 0.0;
<a name="l00166"></a>00166     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l00167"></a>00167         {
<a name="l00168"></a>00168         <span class="keywordflow">for</span>( j = 0; j &lt; i; j++ )
<a name="l00169"></a>00169                 {
<a name="l00170"></a>00170             anorm += a [i] [j] * a [i] [j];
<a name="l00171"></a>00171             vec [i] [j] = vec [j] [i] = 0.0;
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173         vec [i] [i] = 1.0;
<a name="l00174"></a>00174     }
<a name="l00175"></a>00175 
<a name="l00176"></a>00176     <span class="keywordflow">if</span>( anorm &lt;= 0.0 )
<a name="l00177"></a>00177         {
<a name="l00178"></a>00178         <span class="keywordflow">goto</span> done; <span class="comment">/* Matrix hat keine Nebendiagonalelemente */</span>
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     anorm  = sqrt( 4 * anorm );
<a name="l00182"></a>00182     thr    = anorm;
<a name="l00183"></a>00183     anorm /= n;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <span class="keywordflow">while</span>( anorm + thr &gt; anorm )  <span class="comment">/* relative Genauigkeit */</span>
<a name="l00186"></a>00186 <span class="comment">/*  while( 1 + thr &gt; 1 ) */</span>       <span class="comment">/* absolute Genauigkeit */</span>
<a name="l00187"></a>00187     {
<a name="l00188"></a>00188         thr /= n;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         <span class="keywordflow">do</span>
<a name="l00191"></a>00191                 {
<a name="l00192"></a>00192             ind = 0;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194             <span class="keywordflow">for</span>( l = 0; l &lt; n-1; l++ )
<a name="l00195"></a>00195                         {
<a name="l00196"></a>00196                 <span class="keywordflow">for</span>( m = l+1; m &lt; n; m++ )
<a name="l00197"></a>00197                                 {
<a name="l00198"></a>00198                                         <span class="keywordflow">if</span>( fabs( aml = a [m] [l] ) &lt; thr )
<a name="l00199"></a>00199                                         {
<a name="l00200"></a>00200                                                 <span class="keywordflow">continue</span>;
<a name="l00201"></a>00201                                         }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203                                         ind   = 1;
<a name="l00204"></a>00204                                         all   = val [l];
<a name="l00205"></a>00205                                         amm   = val [m];
<a name="l00206"></a>00206                                         x     = (all - amm ) / 2;
<a name="l00207"></a>00207                     y     = -aml / hypot( aml, x );
<a name="l00208"></a>00208                                         <span class="keywordflow">if</span>( x &lt; 0.0 )
<a name="l00209"></a>00209                                         {
<a name="l00210"></a>00210                                                 y = -y;
<a name="l00211"></a>00211                                         }
<a name="l00212"></a>00212                                         sinx  = y / sqrt( 2 * (1 + sqrt( 1 - y * y )));
<a name="l00213"></a>00213                                         sinx2 = sinx * sinx;
<a name="l00214"></a>00214                                         cosx  = sqrt( 1 - sinx2 );
<a name="l00215"></a>00215                                         cosx2 = cosx * cosx;
<a name="l00216"></a>00216                                         sincs = sinx * cosx;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218                     <span class="comment">/* Spalten l und m rotieren */</span>
<a name="l00219"></a>00219                     <span class="keywordflow">for</span>( i = 0; i &lt; n; i++ )
<a name="l00220"></a>00220                                         {
<a name="l00221"></a>00221                                                 <span class="keywordflow">if</span>( (i != m ) &amp;&amp;( i != l ) )
<a name="l00222"></a>00222                                                 {
<a name="l00223"></a>00223                             aim  = i &gt; m ? &amp;a [i] [m] : &amp;a [m] [i];
<a name="l00224"></a>00224                             ail  = i &gt; l ? &amp;a [i] [l] : &amp;a [l] [i];
<a name="l00225"></a>00225                             x    = *ail * cosx - *aim * sinx;
<a name="l00226"></a>00226                             *aim = *ail * sinx + *aim * cosx;
<a name="l00227"></a>00227                             *ail = x;
<a name="l00228"></a>00228                                                 }
<a name="l00229"></a>00229                                                 x = vec [i] [l];
<a name="l00230"></a>00230                                                 y = vec [i] [m];
<a name="l00231"></a>00231                                                 vec [i] [l] = x * cosx - y * sinx;
<a name="l00232"></a>00232                                                 vec [i] [m] = x * sinx + y * cosx;
<a name="l00233"></a>00233                                         }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235                                         x = 2.0 * aml * sincs;
<a name="l00236"></a>00236                                         val   [l] = all * cosx2 + amm * sinx2 - x;
<a name="l00237"></a>00237                                         val   [m] = all * sinx2 + amm * cosx2 + x;
<a name="l00238"></a>00238                                         a [m] [l] = ( all - amm ) * sincs + aml * (cosx2 - sinx2 );
<a name="l00239"></a>00239                                 }
<a name="l00240"></a>00240                         }
<a name="l00241"></a>00241                 }
<a name="l00242"></a>00242                 <span class="keywordflow">while</span>( ind );
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 done:   ;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="comment">/*</span>
<a name="l00248"></a>00248 <span class="comment">     * Eigenwerte sortieren</span>
<a name="l00249"></a>00249 <span class="comment">     */</span>
<a name="l00250"></a>00250     <a class="code" href="eigensort_8cpp.html#a85867998d5a6b2ca11626cda4dde9d5">eigensort</a>( vmatA, dvecA );
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:06:53 2009 for LinAlg by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
