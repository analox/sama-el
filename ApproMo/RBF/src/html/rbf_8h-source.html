<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>rbf.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a></div>
<h1>rbf.h</h1><a href="rbf_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef __RBF__</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define __RBF__</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include "EALib/Population.h"</span>
00005 <span class="preprocessor">#include "Array/ArrayOp.h"</span>
00006 
00007 
00008 
00009 
00010 <span class="keyword">typedef</span> <span class="keyword">enum</span> kernel{ gaussian = 0, linear_spline, cubic_spline,  multiquadric, inverse_multiquadric, cauchy } kernelType;
00011 <span class="keyword">typedef</span> <span class="keyword">enum</span> lm{ interpolate = 0, ridgeRegression, OLS_ForwardSelection } learnMethod; 
00012 <span class="keyword">typedef</span> <span class="keyword">enum</span> err{ GCV = 0, UEV, FPE, BIC } errMethod;
00013 
00014 
00016 
00017 
<a name="l00021"></a><a class="code" href="classRBF.html">00021</a> <span class="keyword">class </span><a class="code" href="classRBF.html">RBF</a> {
00022         <span class="keyword">private</span>:
00023                 <span class="keywordtype">unsigned</span> inputDim;
00024                 <span class="keywordtype">unsigned</span> nBasis;
00025                 <span class="keywordtype">unsigned</span> maxNBasis;
00026                 kernelType kernelFunction;
00027                 errMethod errorMethod;
00028                 learnMethod learner;
00029                 <span class="keywordtype">double</span> regularParam;    
00030                 Array&lt;double&gt; kernelParams;
00031                 <span class="keywordtype">double</span> maxError;
00032                 Array&lt;double&gt; weightMatrix;
00033                 Array&lt;double&gt; designMatrix;
00034                 Array&lt;double&gt; orthogonalMatrix;
00035                 Array&lt;double&gt; orthogonalWeightMatrix;
00036                 Array&lt;double&gt; baseCentres;
00037                 <span class="keywordtype">unsigned</span> maxKMeanIteration;
00038                 <span class="keywordtype">unsigned</span> maxRegIteration;
00039  
00040                 double ( *kernelFuncPtr ) ( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params);
00041                 double ( *errFuncPtr ) ( Array&lt; double &gt; desMatrix, Array&lt; double &gt; output, <span class="keywordtype">double</span> regParam);
00042                 double ( *estRegParamPtr ) ( <span class="keywordtype">double</span> regParam, Array&lt; double &gt; weightMatrix, Array&lt; double &gt; designMatrix, Array&lt; double &gt; predicted);
00043                 <span class="keywordtype">void</span> setDesignVector ( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> index, Array&lt; double &gt; centres, Array&lt; double &gt;&amp; outputVect);
00044                 <span class="keywordtype">void</span> setParams ( <span class="keywordtype">unsigned</span> inDim, kernelType aKernel, Array&lt; double &gt; kernelParams);     
00045                 
00046         <span class="keyword">public</span>:
00048                 <a class="code" href="classRBF.html">RBF</a>( );         
00049 
00051 
00056                 <a class="code" href="classRBF.html">RBF</a>( <span class="keywordtype">unsigned</span> inDim, kernelType aKernel, Array&lt;double&gt; kernelParams );   <span class="comment">//interpolation</span>
00057 
00059 
00070                 <a class="code" href="classRBF.html">RBF</a>( <span class="keywordtype">unsigned</span> inDim, kernelType aKernel, Array&lt;double&gt; kernelParams, <span class="keywordtype">unsigned</span> nKernel, <span class="keywordtype">double</span> regParam, <span class="keywordtype">double</span> maxErr, errMethod anErrMethod, <span class="keywordtype">unsigned</span> maxKMeanIter, <span class="keywordtype">unsigned</span> maxRegIter );     <span class="comment">// ridge regression</span>
00071 
00073 
00080                 <a class="code" href="classRBF.html">RBF</a>( <span class="keywordtype">unsigned</span> inDim, kernelType aKernel, Array&lt;double&gt; kernelParams, <span class="keywordtype">unsigned</span> maximumBasis,  <span class="keywordtype">double</span> maxErr );           <span class="comment">// OLS-forward selection</span>
00081 
00083                 ~<a class="code" href="classRBF.html">RBF</a>( );
00084 
00086 
00089                 <span class="keywordtype">void</span> evaluate( Individual&amp; offspring );
00090                 
00092 
00095                 <span class="keywordtype">void</span> evaluate( Population&amp; offsprings );
00096                 
00098 
00102                 <span class="keywordtype">void</span> evaluate( Array &lt; double &gt; inputData, Array &lt; double &gt;&amp; outputData );
00103                 <span class="keywordtype">void</span> Evaluate( Array &lt; double &gt; inputData, Array &lt; double &gt;&amp; outputData );
00104 
00105 
00106 
00108 
00113                 <span class="keywordtype">double</span> mse( Array &lt; double &gt; Input, Array &lt; double &gt; Target );
00114                 <span class="keywordtype">double</span> mse2( Array &lt; double &gt; Input, Array &lt; double &gt; Target );
00115 
00117 
00121                 <span class="keywordtype">double</span> mse( Population offsprings );
00122                 
00124 
00128                 <span class="keywordtype">void</span> train( Array &lt; double &gt; InputData, Array &lt; double &gt; TargetData );
00129                 
00130 
00132 
00135                 <span class="keywordtype">void</span> setDesignMatrix( Array&lt; double &gt;&amp; inputData );
00136                 <span class="keywordtype">void</span> setDesignMatrix2( Array&lt; double &gt;&amp; inputData );
00137 
00139 
00143                 <span class="keywordtype">void</span> setWeightMatrix( Array&lt; double &gt;&amp; targetData );
00144                 
00145                 <span class="keywordtype">void</span> setWeightMatrix2( Array&lt; double &gt;&amp; targetData );
00146 
00147 
00149 
00152                 Array&lt;double&gt; getDesignMatrix( );
00153 
00155 
00158                 Array&lt;double&gt; getWeightMatrix( );
00159 
00161 
00164                 Array&lt;double&gt; getOrthogonalMatrix( );
00165 
00167 
00170                 Array&lt;double&gt; getOrthogonalWeightMatrix( );
00171                 
00173 
00176                 Array&lt;double&gt; getBaseCentres( );
00177 
00179 
00186                 <span class="keyword">static</span> <span class="keywordtype">double</span> getDistance( Array&lt; double &gt;&amp; input, <span class="keywordtype">unsigned</span> i, Array&lt;double&gt;&amp; centre, <span class="keywordtype">unsigned</span> j );
00187 
00189 
00197                 <span class="keyword">static</span> <span class="keywordtype">double</span> gaussFunc( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params );
00198 
00200 
00208                 <span class="keyword">static</span> <span class="keywordtype">double</span> cubicFunc( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params );
00209 
00211 
00219                 <span class="keyword">static</span> <span class="keywordtype">double</span> linearFunc( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params );
00220 
00221 
00223 
00231                 <span class="keyword">static</span> <span class="keywordtype">double</span> multiquadricFunc( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params);
00232 
00234 
00242                 <span class="keyword">static</span> <span class="keywordtype">double</span> inverseMultiquadricFunc( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params);
00243 
00245 
00253                 <span class="keyword">static</span> <span class="keywordtype">double</span> cauchyFunc( Array&lt; double &gt; input, <span class="keywordtype">unsigned</span> i, Array&lt; double &gt; centre, <span class="keywordtype">unsigned</span> j, Array&lt; double &gt; params );              
00254 
00256 
00263                 <span class="keyword">static</span> <span class="keywordtype">double</span> YPYFunc( Array&lt; double &gt; desMatrix, Array&lt; double &gt; output, <span class="keywordtype">double</span> regParam, Array&lt; double &gt;&amp; A ); <span class="comment">//Compute Sum Squared Error analytically</span>
00264 
00266 
00272                 <span class="keyword">static</span> <span class="keywordtype">double</span> GCVFunc( Array&lt; double &gt; desMatrix, Array&lt; double &gt; output, <span class="keywordtype">double</span> regParam ); <span class="comment">// Generalized Cross-Validation</span>
00273 
00275 
00281                 <span class="keyword">static</span> <span class="keywordtype">double</span> UEVFunc( Array&lt; double &gt; desMatrix, Array&lt; double &gt; output, <span class="keywordtype">double</span> regParam ); <span class="comment">// Unbiased Estimate Variance</span>
00282 
00284 
00290                 <span class="keyword">static</span> <span class="keywordtype">double</span> FPEFunc( Array&lt; double &gt; desMatrix, Array&lt; double &gt; output, <span class="keywordtype">double</span> regParam ); <span class="comment">// Final Prediction Error</span>
00291                 
00293 
00299                 <span class="keyword">static</span> <span class="keywordtype">double</span> BICFunc( Array&lt; double &gt; desMatrix, Array&lt; double &gt; output, <span class="keywordtype">double</span> regParam ); <span class="comment">// Bayesian Information Criterion</span>
00300 
00302 
00309                 <span class="keyword">static</span> <span class="keywordtype">double</span> estRegParamGCV( <span class="keywordtype">double</span> regParam, Array&lt; double &gt; weightMatrix, Array&lt; double &gt; designMatrix, Array&lt; double &gt; predicted);
00310                 
00312 
00319                 <span class="keyword">static</span> <span class="keywordtype">double</span> estRegParamUEV( <span class="keywordtype">double</span> regParam, Array&lt; double &gt; weightMatrix, Array&lt; double &gt; designMatrix, Array&lt; double &gt; predicted);
00320 
00322 
00329                 <span class="keyword">static</span> <span class="keywordtype">double</span> estRegParamFPE( <span class="keywordtype">double</span> regParam, Array&lt; double &gt; weightMatrix, Array&lt; double &gt; designMatrix, Array&lt; double &gt; predicted);
00330 
00332 
00339                 <span class="keyword">static</span> <span class="keywordtype">double</span> estRegParamBIC( <span class="keywordtype">double</span> regParam, Array&lt; double &gt; weightMatrix, Array&lt; double &gt; designMatrix, Array&lt; double &gt; predicted);
00340 
00342 
00349                 <span class="keyword">static</span> <span class="keywordtype">void</span> KMean( <span class="keywordtype">unsigned</span> nCluster, <span class="keywordtype">unsigned</span> maxIter, Array&lt; double &gt; input, Array&lt; double &gt;&amp; centresFound, Array&lt; unsigned &gt;&amp; clustMap);
00350                 
00352 
00355                 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Type&gt;
<a name="l00356"></a><a class="code" href="classRBF.html#e17">00356</a>                 <span class="keyword">static</span> <span class="keywordtype">void</span> initArrayToZero( Array&lt; Type &gt;&amp; arr ) {
00357                 
00358                         <span class="keywordtype">unsigned</span> i, j;
00359                         <span class="keywordflow">for</span> ( i = 0; i &lt; arr.dim( 0 ); i++ ) {
00360                                 <span class="keywordflow">for</span> ( j = 0; j &lt; arr.dim( 1 ); j++ ) {
00361                                         arr( i, j ) = 0;
00362                                 }
00363                         }       
00364                 }
00365 };
00366 
00367 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Sep 25 17:20:14 2007 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
