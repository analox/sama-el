<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: CrossEntropy Class Reference</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>CrossEntropy Class Reference</h1><!-- doxytag: class="CrossEntropy" --><!-- doxytag: inherits="ModelInterface" -->Error measure for classication tasks that can be used as the objective function for training.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_cross_entropy_8h-source.html">CrossEntropy.h</a>&gt;</code>
<p>
<p>Inheritance diagram for CrossEntropy:
<p><center><img src="class_cross_entropy.png" usemap="#CrossEntropy_map" border="0" alt=""></center>
<map name="CrossEntropy_map">
<area href="class_model_interface.html" alt="ModelInterface" shape="rect" coords="0,0,97,24">
</map>
<a href="class_cross_entropy-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cross_entropy.html#288c983b7c621250b08529a698ced6fa">error</a> (const Array&lt; double &gt; &amp;<a class="el" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, const Array&lt; double &gt; &amp;target)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates the cross entropy error.  <a href="#288c983b7c621250b08529a698ced6fa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_cross_entropy.html#a08f32f86ab11bbb2cb101cd6a3e84c1">derror</a> (const Array&lt; double &gt; &amp;<a class="el" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, const Array&lt; double &gt; &amp;target, bool returnError=true)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculates the derivatives of the cross entropy error (see <a class="el" href="class_cross_entropy.html#288c983b7c621250b08529a698ced6fa">error</a>) with respect to the parameters <a class="el" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">ModelInterface::w</a>.  <a href="#a08f32f86ab11bbb2cb101cd6a3e84c1"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Error measure for classication tasks that can be used as the objective function for training. 
<p>
If your model should return a vector whose components are reflecting the class conditonal probabilities of class membership given any input vector 'CrossEntropy' is the adequate error measure for model-training. For <em>C&gt;1</em>, dimension of model's output and every output dimension represents the probability for class membership of the given input vector, the error measure applied is defined as <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \sum_{k=1}^C \left\{tar^i_k \cdot\ln \frac{\exp{(model_k(in^i))}} {\sum_{k^{\prime}=1}^C \exp{(model_{k^{\prime}}(in^i))}} \right\} \]" src="form_123.png">
<p>
 where <em>i</em> runs over all input patterns and every term in the sum equals zero if the coefficient equals zero, since <em>x</em> <em>ln(x)</em> is zero in limes of x running to zero. The argument of the logarithm calculates the so called softmax-activation to guarantee for unity at the outputs, i.e. <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_{k=1}^C \frac{\exp{(model_k(in^i))}}{\sum_{k^{\prime}=1}^C \exp{(model_{k^{\prime}}(in^i))}} = 1 \]" src="form_124.png">
<p>
 This is neccessary in order to interprete the output values as probabilities. This error functional can be derivated and so used for training. In case of only one single output dimension 'CrossEntropy' returns the corresponding cross entropy for two classes, using the formalism <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \left\{tar^i\cdot \ln model(in^i) + (1-tar^i) \cdot\ln (1-model(in^i))\right\} \]" src="form_125.png">
<p>
<p>
In this implementation every target value has to be chosen from {0,1} (binary encoding). For theoretical reasons it is suggested to use for neural networks with one output neuron the logistic sigmoid activation function at the output. For multiple outputs it's required to use linear activiation, since this error implementation transforms the linear output to the softmax activiation as described above. For detailed information refer to (C.M. Bishop, Neural Networks for Pattern Recognition, Clarendon Press 1996, Chapter 6.9.)<p>
This implementation of the cross entropy performs less efficient than the implemetation given in 'DF_CrossEntropy.h' for more than one output dimensions, if standard model classes as 'FFNet' are simultaneously linked, because redundant calculations of the outer derivatives are not circumvented.<p>
<dl compact><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes:</b></dt><dd>Revision 2003/06/03 (S. Wiegand): softmax activation introduced, bugs in calculation of derivatives corrected</dd></dl>
<dl compact><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>

<p>
Definition at line <a class="el" href="_cross_entropy_8h-source.html#l00172">172</a> of file <a class="el" href="_cross_entropy_8h-source.html">CrossEntropy.h</a>.<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a08f32f86ab11bbb2cb101cd6a3e84c1"></a><!-- doxytag: member="CrossEntropy::derror" ref="a08f32f86ab11bbb2cb101cd6a3e84c1" args="(const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target, bool returnError=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CrossEntropy::derror           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>returnError</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the derivatives of the cross entropy error (see <a class="el" href="class_cross_entropy.html#288c983b7c621250b08529a698ced6fa">error</a>) with respect to the parameters <a class="el" href="class_model_interface.html#339f927ac126f94636cfe839e0c7c935">ModelInterface::w</a>. 
<p>
The derivatives of the cross entropy for <em>N</em> patterns and <em>C&gt;1</em> class-dimensions within the output vector with respect to model parameters <em>w</em> are calculated via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial w} = - \sum_{i=1}^N \sum_{k=1}^C \left\{ \left( tar^i_k - \frac{\exp{(model_k(in^i))}}{\sum_{k^{\prime}=1}^C \exp{(model_{k^{\prime}}(in^i))}} \right) \cdot\frac{\partial model_k(in^i)}{\partial w}\right\} \]" src="form_128.png">
<p>
 respectively for only one single output dimension via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial E}{\partial w} = - \sum_{i=1}^N \left\{ \frac{tar^i - model(in^i)}{model(in^i)\cdot(1-model(in^i))} \cdot\frac{\partial model(in^i)}{\partial w}\right\} \]" src="form_129.png">
<p>
 Usually, as a byproduct of the calculation of the derivative one gets the cross entropy error itself very efficiently. Therefore, the method <a class="el" href="class_cross_entropy.html#288c983b7c621250b08529a698ced6fa">error</a> gives back this value. This additional effect can be switched of by means of the third parameter (returnError = false).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Input vector for the model. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target</em>&nbsp;</td><td>Target vector. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>returnError</em>&nbsp;</td><td>Determines whether or not to calculate the cross entropy error itself. By default the error is calculated. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The cross entropy error if <em>returnError</em> is set to "true", "-1" otherwise.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>Revision 2003/06/03 (S. Wiegand): softmax activation introduced, bugs in calculation of derivatives corrected</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Reimplemented from <a class="el" href="class_model_interface.html#027f3b43e09f37f614ee56c4ebf8a2ae">ModelInterface</a>.
<p>
Definition at line <a class="el" href="_cross_entropy_8h-source.html#l00315">315</a> of file <a class="el" href="_cross_entropy_8h-source.html">CrossEntropy.h</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00221">ModelInterface::dedw</a>, <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>, <a class="el" href="_model_interface_8h-source.html#l00387">ModelInterface::dmodel()</a>, and <a class="el" href="_model_interface_8h-source.html#l00228">ModelInterface::outputDimension</a>.
</div>
</div><p>
<a class="anchor" name="288c983b7c621250b08529a698ced6fa"></a><!-- doxytag: member="CrossEntropy::error" ref="288c983b7c621250b08529a698ced6fa" args="(const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CrossEntropy::error           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>target</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Calculates the cross entropy error. 
<p>
The cross entropy function for <em>N</em> patterns and <em>C&gt;1</em> class-dimensions within the output vector is calculated via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \sum_{k=1}^C \left\{tar^i_k\cdot \ln \frac{\exp{(model_k(in^i))}} {\sum_{k^{\prime}=1}^C \exp{(model_{k^{\prime}}(in^i))}}\right\} \]" src="form_126.png">
<p>
 respectively for only one single output dimension and two classes via <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E = - \sum_{i=1}^N \left\{tar^i\cdot \ln model(in^i) + (1-tar^i) \ln (1-model(in^i))\right\} \]" src="form_127.png">
<p>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Input-Matrix for the model. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target</em>&nbsp;</td><td>Target vector. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The error <em>E</em>.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Huesken </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>Revision 2003/06/03 (S. Wiegand): softmax activation introduced</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Implements <a class="el" href="class_model_interface.html#adc756409ac6ceabb9bba3061c447fdd">ModelInterface</a>.
<p>
Definition at line <a class="el" href="_cross_entropy_8h-source.html#l00212">212</a> of file <a class="el" href="_cross_entropy_8h-source.html">CrossEntropy.h</a>.
<p>
References <a class="el" href="class_model_interface.html#e7c9c3ab5397b01628d254b71f941784">ModelInterface::model()</a>, and <a class="el" href="_model_interface_8h-source.html#l00228">ModelInterface::outputDimension</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_cross_entropy_8h-source.html">CrossEntropy.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:16 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
