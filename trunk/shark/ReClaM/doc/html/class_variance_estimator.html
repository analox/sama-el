<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: VarianceEstimator Class Reference</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>VarianceEstimator Class Reference</h1><!-- doxytag: class="VarianceEstimator" --><!-- doxytag: inherits="ModelInterface" -->Offers the methods to deal with active learning of a neural network.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_variance_estimator_8h-source.html">VarianceEstimator.h</a>&gt;</code>
<p>
<p>Inheritance diagram for VarianceEstimator:
<p><center><img src="class_variance_estimator.png" usemap="#VarianceEstimator_map" border="0" alt=""></center>
<map name="VarianceEstimator_map">
<area href="class_model_interface.html" alt="ModelInterface" shape="rect" coords="0,0,115,24">
</map>
<a href="class_variance_estimator-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#32fa7083d0bdeabe5354e718e3320586">VarianceEstimator</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a new instance of class "Variance Estimator".  <a href="#32fa7083d0bdeabe5354e718e3320586"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#ee6ec0dbdfa4ccaeafd2826d7a024e88">estimateFisherInformation</a> (const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;infMatA)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The Fisher information matrix is estimated.  <a href="#ee6ec0dbdfa4ccaeafd2826d7a024e88"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#ac3f600b3f3a310a178774345aeee8bc">estimateInvFisher</a> (const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;invInfMatA, Array&lt; double &gt; &amp;transInvInfMatA, double &amp;s2A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Estimates the inverse Fisher information matrix and other values used for quantifying changes in variance due to active learning.  <a href="#ac3f600b3f3a310a178774345aeee8bc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#385de2bb9fafb938507fc45f0143b8ed">estimateVariance</a> (const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The estimated output variance of the network for one input pattern is returned.  <a href="#385de2bb9fafb938507fc45f0143b8ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#ed0ef10ef69d1cae7e9129831f14718d">estimateVarianceChange</a> (const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA, const Array&lt; double &gt; &amp;transInvInfMatA, double s2A)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Estimates the change in the output variance after an active learning step.  <a href="#ed0ef10ef69d1cae7e9129831f14718d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_variance_estimator.html#857fb6e58741db48247b0ef0e2e9da60">overallVariance</a> (const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The estimated output variance of the network for all input patterns is returned.  <a href="#857fb6e58741db48247b0ef0e2e9da60"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Offers the methods to deal with active learning of a neural network. 
<p>
Most neural networks are used as passive learners, i.e. they will work on a fixed training set. In natural learning problems, however, the learner can gather new information from its environment to improve the learning process. Using active learning in connection with neural networks, the network is allowed to select a new training input <img class="formulaInl" alt="$\tilde{x}$" src="form_50.png"> at each time step. <br>
 To achieve a real improvement of the learning process, the selected new input is not chosen by random. The goal is to chose an input, that minimizes the expectation of the learner's mean squared error. So you will find methods here, that will estimate the output variance of the network, when adding a new example to the training set. <br>
 For more details about active learning in neural networks and the formulas used here for the variance estimations, please refer to David A. Cohn: "Neural Network Exploration Using Optimal Experimental Design."<p>
<dl compact><dt><b>Example</b></dt><dd><div class="fragment"><pre class="fragment">  <span class="comment">// Create own network class using Variance Estimator:</span>
  <span class="keyword">class </span>MyNet : <span class="keyword">public</span> <a class="code" href="class_f_f_net.html">FFNet</a>,
                <span class="keyword">public</span> <a class="code" href="class_mean_squared_error.html">MeanSquaredError</a>,
                ...,
                <span class="keyword">public</span> <a class="code" href="class_variance_estimator.html">VarianceEstimator</a>

  {
      ...
  }

  <span class="keywordtype">void</span> main() 
  {

      <span class="comment">// Create net:</span>
      MyNet net;

      <span class="comment">// Fill net:</span>
      ...
  
      <span class="comment">// Training the net:</span>
      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> epoch = 1; epoch &lt; max_epochs; epoch++ )
      {
          <span class="comment">// Train net with prefered optimization algorithm:</span>
          ...

          <span class="comment">// Estimate current variance of the model:                    </span>
          currVar = net.overallVariance( inputTrain, targetTrain );
       
          <span class="comment">// Active learning step - choose one of the patterns</span>
          <span class="comment">// of the additional set, that will decrease the</span>
          <span class="comment">// variance most and add it to the training set:</span>
          <span class="comment">// </span>
          <span class="comment">// Calculates values "invInfMat", "transInvInfMat" and "s2", </span>
          <span class="comment">// that are necessary for the estimation</span>
          <span class="comment">// of the variance change:</span>
          net.estimateInvFisher( inputTrain, targetTrain, 
                                 invInfMat, transInvInfMat, s2 );

          <span class="comment">// Estimate variance change of the model for all patterns</span>
          <span class="comment">// of the additional set:</span>
          <span class="keywordflow">for</span> ( i = 0; i &lt; no_additionals; i++ )
          {
              varChange = 
                  net.estimateVarianceChange( inputAdditional[ i ], 
                                              invInfMat, 
                                              transInvInfMat, s2    );

              ...
          }

          <span class="comment">// Choose pattern which minimizes the model variance:</span>
          ...

          <span class="comment">// Monitor variance at the chosen reference point:</span>
          refVar = net.estimateVariance( inputAdditional[ bestIndex ],
                                           invInfMat                     );

          <span class="comment">// Add chosen pattern to the training set:</span>
          ...

      } <span class="comment">// next training epoch</span>
  }     
</pre></div></dd></dl>
This example shows, how to use the variance estimation. <br>
 In addition to your "normal" training set, you also use a set of additional patterns (predefined or random), that can be added one by one to the original training set. <br>
 For each active learning step add one pattern to the training set and use the methods of class <a class="el" href="class_variance_estimator.html">VarianceEstimator</a> to choose the pattern, that will decrease the variance of the current model at most. <br>
<p>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes:</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>

<p>
Definition at line <a class="el" href="_variance_estimator_8h-source.html#l00195">195</a> of file <a class="el" href="_variance_estimator_8h-source.html">VarianceEstimator.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="32fa7083d0bdeabe5354e718e3320586"></a><!-- doxytag: member="VarianceEstimator::VarianceEstimator" ref="32fa7083d0bdeabe5354e718e3320586" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VarianceEstimator::VarianceEstimator           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a new instance of class "Variance Estimator". 
<p>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_variance_estimator_8h-source.html#l00214">214</a> of file <a class="el" href="_variance_estimator_8h-source.html">VarianceEstimator.h</a>.
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="ee6ec0dbdfa4ccaeafd2826d7a024e88"></a><!-- doxytag: member="VarianceEstimator::estimateFisherInformation" ref="ee6ec0dbdfa4ccaeafd2826d7a024e88" args="(const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;infMatA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VarianceEstimator::estimateFisherInformation           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>outputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>infMatA</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The Fisher information matrix is estimated. 
<p>
Given a training set with input patterns <img class="formulaInl" alt="$x_i$" src="form_51.png"> with the corresponding target values <img class="formulaInl" alt="$y_i \mbox{,\ } i = 1, \dots, m$" src="form_52.png"> the current value of the used negative log likelihood measure of the weights (also called a score) is proportional to<p>
<img class="formulaInl" alt="$ S^2 = \frac{1}{m} \sum_{i = 1}^m (y_i - \hat{y}(x_i))^2 $" src="form_53.png"><p>
where <img class="formulaInl" alt="$\hat{y}$" src="form_54.png"> is the output of the used network for the input <img class="formulaInl" alt="$x_i$" src="form_51.png">. After calculating the value of the measure, the Fisher information matrix can be estimated by<p>
<img class="formulaInl" alt="$ A = \frac{1}{S^2} \sum_{i = 1}^m \frac{\partial \hat{y}}{\partial w} \frac{\partial \hat{y}}{\partial w}^T $" src="form_55.png"><p>
where <img class="formulaInl" alt="$\hat{y} = f_{\hat{w}}(x)$" src="form_56.png"> is the learners best guess for mapping inputs <img class="formulaInl" alt="$x$" src="form_57.png"> to outputs <img class="formulaInl" alt="$y$" src="form_58.png"> with <img class="formulaInl" alt="$\hat{w}$" src="form_59.png"> as the weight vector of the network that minimizes the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_60.png">, i.e. <img class="formulaInl" alt="$\hat{y}$" src="form_54.png"> is an estimate of the corresponding <img class="formulaInl" alt="$y$" src="form_58.png">.<br>
 The Fisher information matrix measures the information contained in the training data set about each parameter (i.e. each weight).<br>
 The inverse of the matrix then provides an approximation to the variance of the maximum-likelihood estimator which becomes increasingly accurate as the sample size increases.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inputA</em>&nbsp;</td><td>The input patterns <img class="formulaInl" alt="$x_i$" src="form_51.png"> of the training set. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outputA</em>&nbsp;</td><td>The target values <img class="formulaInl" alt="$y_i$" src="form_61.png"> for the used input patterns. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>infMatA</em>&nbsp;</td><td>The calculated Fisher information matrix <img class="formulaInl" alt="$A$" src="form_62.png">. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>check_exception</em>&nbsp;</td><td>the type of the exception will be "size mismatch" and indicates that <em>inputA</em> is not 2-dimensional</td></tr>
  </table>
</dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_variance_estimator_8cpp-source.html#l00141">141</a> of file <a class="el" href="_variance_estimator_8cpp-source.html">VarianceEstimator.cpp</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>.
</div>
</div><p>
<a class="anchor" name="ac3f600b3f3a310a178774345aeee8bc"></a><!-- doxytag: member="VarianceEstimator::estimateInvFisher" ref="ac3f600b3f3a310a178774345aeee8bc" args="(const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA, Array&lt; double &gt; &amp;invInfMatA, Array&lt; double &gt; &amp;transInvInfMatA, double &amp;s2A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VarianceEstimator::estimateInvFisher           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>outputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>invInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>transInvInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&nbsp;</td>
          <td class="paramname"> <em>s2A</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Estimates the inverse Fisher information matrix and other values used for quantifying changes in variance due to active learning. 
<p>
Given all input patterns <img class="formulaInl" alt="$x_i \mbox{,\ } i = 1, \dots, m$" src="form_63.png"> of the training set and the corresponding target values <img class="formulaInl" alt="$y_i$" src="form_61.png"> three values/matrices are calculated:<p>
<ul>
<li>
the inverse Fisher information matrix (<img class="formulaInl" alt="$A^{-1}$" src="form_64.png">) </li>
<li>
the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_60.png">  </li>
<li>
<img class="formulaInl" alt="$A^{-1} \cdot {\langle \frac{\partial \hat{y}}{\partial w}\frac{\partial \hat{y}}{\partial w}^T \rangle}_X \cdot A^{-1}$" src="form_65.png">, where <img class="formulaInl" alt="${\langle \cdot \rangle}_X$" src="form_66.png"> represents the expected value over <img class="formulaInl" alt="$X$" src="form_67.png">. </li>
</ul>
<p>
For the definition of <img class="formulaInl" alt="$A$" src="form_62.png">, <img class="formulaInl" alt="$S^2$" src="form_60.png"> and <img class="formulaInl" alt="$\hat{y}$" src="form_54.png"> please refer to method <a class="el" href="class_variance_estimator.html#ee6ec0dbdfa4ccaeafd2826d7a024e88">estimateFisherInformation</a>. <br>
 The three evaluated values are used for the calculation of the expected change in the output variance (calculated by method <a class="el" href="class_variance_estimator.html#ed0ef10ef69d1cae7e9129831f14718d">estimateVarianceChange</a>), after a new example <img class="formulaInl" alt="$(\tilde{x}, \tilde{y})$" src="form_68.png"> is added to the training set.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inputA</em>&nbsp;</td><td>The input patterns <img class="formulaInl" alt="$x_i$" src="form_51.png"> of the training set, including the new input pattern <img class="formulaInl" alt="$\tilde{x}$" src="form_50.png">. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outputA</em>&nbsp;</td><td>The target values <img class="formulaInl" alt="$y_i$" src="form_61.png"> for the used input patterns. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>invInfMatA</em>&nbsp;</td><td>The calculated inverse Fisher information matrix <img class="formulaInl" alt="$A^{-1}$" src="form_64.png">. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>transInvInfMatA</em>&nbsp;</td><td>The third calculated value as listed above. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s2A</em>&nbsp;</td><td>The current value of the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_60.png">.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>check_exception</em>&nbsp;</td><td>the type of the exception will be "size mismatch" and indicates that <em>inputA</em> is not 2-dimensional</td></tr>
  </table>
</dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_variance_estimator.html#ac3f600b3f3a310a178774345aeee8bc">estimateInvFisher</a> </dd></dl>

<p>
Definition at line <a class="el" href="_variance_estimator_8cpp-source.html#l00229">229</a> of file <a class="el" href="_variance_estimator_8cpp-source.html">VarianceEstimator.cpp</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>.
</div>
</div><p>
<a class="anchor" name="385de2bb9fafb938507fc45f0143b8ed"></a><!-- doxytag: member="VarianceEstimator::estimateVariance" ref="385de2bb9fafb938507fc45f0143b8ed" args="(const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double VarianceEstimator::estimateVariance           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>invInfMatA</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The estimated output variance of the network for one input pattern is returned. 
<p>
Given one input pattern, the output variance <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_69.png"> at this reference input <img class="formulaInl" alt="$x_r$" src="form_70.png"> can be approximated by <img class="formulaInl" alt="$ \sigma^2_{\hat{y}|x_r} \approx \frac{\partial \hat{y}}{\partial w}^T A^{-1} \frac{\partial \hat{y}}{\partial w} $" src="form_73.png"><p>
where <img class="formulaInl" alt="$\hat{y} = f_{\hat{w}}(x)$" src="form_56.png"> is the learners best guess for mapping inputs <img class="formulaInl" alt="$x$" src="form_57.png"> to outputs <img class="formulaInl" alt="$y$" src="form_58.png"> with <img class="formulaInl" alt="$\hat{w}$" src="form_59.png"> as the weight vector of the network that minimizes the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_60.png"> and <img class="formulaInl" alt="$A^{-1}$" src="form_64.png"> is the inverse Fisher information matrix (see method <a class="el" href="class_variance_estimator.html#ee6ec0dbdfa4ccaeafd2826d7a024e88">estimateFisherInformation</a> for details).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inputA</em>&nbsp;</td><td>The reference input pattern <img class="formulaInl" alt="$x_r$" src="form_70.png"> of the training set. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>invInfMatA</em>&nbsp;</td><td>The calculated inverse Fisher information matrix <img class="formulaInl" alt="$A^{-1}$" src="form_64.png">. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The estimated output variance <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_69.png">.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_variance_estimator_8cpp-source.html#l00416">416</a> of file <a class="el" href="_variance_estimator_8cpp-source.html">VarianceEstimator.cpp</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>.
</div>
</div><p>
<a class="anchor" name="ed0ef10ef69d1cae7e9129831f14718d"></a><!-- doxytag: member="VarianceEstimator::estimateVarianceChange" ref="ed0ef10ef69d1cae7e9129831f14718d" args="(const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;invInfMatA, const Array&lt; double &gt; &amp;transInvInfMatA, double s2A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double VarianceEstimator::estimateVarianceChange           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>invInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>transInvInfMatA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>s2A</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Estimates the change in the output variance after an active learning step. 
<p>
When active learning takes place, i.e. a chosen input <img class="formulaInl" alt="$\tilde{x}$" src="form_50.png"> and its corresponding <img class="formulaInl" alt="$\tilde{y}$" src="form_74.png"> are added to the training set, the variance of the model will change. Then the variance change has to be computed to select <img class="formulaInl" alt="$\tilde{x}$" src="form_50.png"> optimally. <br>
 The expected change in output variance can be estimated by <p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\langle \Delta \sigma^2_{\hat{y}|\tilde{x}}\rangle}_{X,\tilde{Y}} = \frac{\frac{\partial \hat{y}}{\partial w}^T \cdot {\langle \frac{\partial \hat{y}}{\partial w}\frac{\partial \hat{y}}{\partial w}^T \rangle}_X \cdot A^{-1} \cdot \frac{\partial \hat{y}}{\partial w}}{S^2 + \frac{\partial \hat{y}}{\partial w}^T \cdot A^{-1} \cdot \frac{\partial \hat{y}}{\partial w}}, \]" src="form_75.png">
<p>
 where <img class="formulaInl" alt="${\langle \cdot \rangle}_{X, \tilde{Y}}$" src="form_76.png"> represents the expected values over <img class="formulaInl" alt="$X$" src="form_67.png"> and <img class="formulaInl" alt="$\tilde{Y}$" src="form_77.png">. <br>
 For a definition of <img class="formulaInl" alt="$S^2$" src="form_60.png">, <img class="formulaInl" alt="$A$" src="form_62.png"> and <img class="formulaInl" alt="$\hat{y}$" src="form_54.png"> please refer to method <a class="el" href="class_variance_estimator.html#ee6ec0dbdfa4ccaeafd2826d7a024e88">estimateFisherInformation</a>. <br>
 The values used for the calculation of the variance change can be calculated by using method <a class="el" href="class_variance_estimator.html#ac3f600b3f3a310a178774345aeee8bc">estimateInvFisher</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inputA</em>&nbsp;</td><td>The new input pattern <img class="formulaInl" alt="$\tilde{x}$" src="form_50.png"> that should be added to the training set. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>invInfMatA</em>&nbsp;</td><td>The inverse Fisher information matrix. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>transInvInfMatA</em>&nbsp;</td><td>A term that is used for the calculation of the variance change. For a definition of this term please refer to method <a class="el" href="class_variance_estimator.html#ac3f600b3f3a310a178774345aeee8bc">estimateInvFisher</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>s2A</em>&nbsp;</td><td>The current value of the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_60.png">. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd></dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="class_variance_estimator.html#ac3f600b3f3a310a178774345aeee8bc">estimateInvFisher</a> </dd></dl>

<p>
Definition at line <a class="el" href="_variance_estimator_8cpp-source.html#l00472">472</a> of file <a class="el" href="_variance_estimator_8cpp-source.html">VarianceEstimator.cpp</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>.
</div>
</div><p>
<a class="anchor" name="857fb6e58741db48247b0ef0e2e9da60"></a><!-- doxytag: member="VarianceEstimator::overallVariance" ref="857fb6e58741db48247b0ef0e2e9da60" args="(const Array&lt; double &gt; &amp;inputA, const Array&lt; double &gt; &amp;outputA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double VarianceEstimator::overallVariance           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>inputA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>outputA</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The estimated output variance of the network for all input patterns is returned. 
<p>
The average variance over all input patterns <img class="formulaInl" alt="$x_i \mbox{,\ } i = 1, \dots, m$" src="form_63.png"> is calculated by a stochastic estimate based on an average of <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_69.png"> with a reference point <img class="formulaInl" alt="$x_r$" src="form_70.png"> drawn according to the known input distribution (for a calculation of <img class="formulaInl" alt="$\sigma^2_{\hat{y}|x_r}$" src="form_69.png"> for a single reference point <img class="formulaInl" alt="$x_r$" src="form_70.png"> please refer to method <a class="el" href="class_variance_estimator.html#385de2bb9fafb938507fc45f0143b8ed">estimateVariance</a>). <br>
 The overall variance is then estimated by<p>
<img class="formulaInl" alt="$ {\langle \sigma^2_{\hat{y}} \rangle}_X = {\langle \frac{\partial \hat{y}}{\partial w}\rangle}_X^T A^{-1} {\langle \frac{\partial \hat{y}}{\partial w}\rangle}_X + \mbox{trace}(A^{-1} {\langle \frac{\partial \hat{y}}{\partial w} \rangle}_X^T {\langle \frac{\partial \hat{y}}{\partial w}\rangle}_X) $" src="form_71.png"><p>
where <img class="formulaInl" alt="$\hat{y} = f_{\hat{w}}(x)$" src="form_56.png"> is the learners best guess for mapping inputs <img class="formulaInl" alt="$x$" src="form_57.png"> to outputs <img class="formulaInl" alt="$y$" src="form_58.png"> with <img class="formulaInl" alt="$\hat{w}$" src="form_59.png"> as the weight vector of the network that minimizes the negative log likelihood measure <img class="formulaInl" alt="$S^2$" src="form_60.png">, <img class="formulaInl" alt="$A^{-1}$" src="form_64.png"> is the inverse Fisher information matrix (see method <a class="el" href="class_variance_estimator.html#ee6ec0dbdfa4ccaeafd2826d7a024e88">estimateFisherInformation</a> for details) and <img class="formulaInl" alt="${\langle \cdot \rangle}_X$" src="form_66.png"> represents the expected value over <img class="formulaInl" alt="$X$" src="form_67.png">.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>inputA</em>&nbsp;</td><td>The input patterns <img class="formulaInl" alt="$x_i$" src="form_51.png"> of the training set. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>outputA</em>&nbsp;</td><td>The corresponding target values <img class="formulaInl" alt="$y_i$" src="form_61.png"> of the input patterns. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The estimated output variance <img class="formulaInl" alt="${\langle \sigma^2_{\hat{y}} \rangle}_X$" src="form_72.png">. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>check_exception</em>&nbsp;</td><td>the type of the exception will be "size mismatch" and indicates that <em>inputA</em> is not 2-dimensional</td></tr>
  </table>
</dl>
<dl compact><dt><b>Author:</b></dt><dd>M. Kreutz </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2001-05-04</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_variance_estimator_8cpp-source.html#l00334">334</a> of file <a class="el" href="_variance_estimator_8cpp-source.html">VarianceEstimator.cpp</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00216">ModelInterface::dmdw</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_variance_estimator_8h-source.html">VarianceEstimator.h</a><li><a class="el" href="_variance_estimator_8cpp-source.html">VarianceEstimator.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:17 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
