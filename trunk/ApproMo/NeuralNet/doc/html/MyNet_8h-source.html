<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MyNet.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; </center>
<hr><h1>MyNet.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef __MyNet__</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define __MyNet__</span>
00003 <span class="preprocessor"></span>
00004 <span class="preprocessor">#include &lt;ReClaM/MSEFFNet.h&gt;</span>
00005 <span class="preprocessor">#include &lt;ReClaM/Rprop.h&gt;</span>
00006 <span class="preprocessor">#include &lt;ReClaM/MeanSquaredError.h&gt;</span>
00007 <span class="preprocessor">#include &lt;ReClaM/ErrorMeasures.h&gt;</span>
00008 
00009 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00011 
<a name="l00042"></a><a class="code" href="classMyNet.html">00042</a> <span class="keyword">class </span><a class="code" href="classMyNet.html">MyNet</a> : <span class="keyword">public</span> MSEFFNet,       <span class="comment">// feed-forward network</span>
00043   <span class="keyword">public</span> IRpropPlus,     <span class="comment">// resilent backpropagation</span>
00044   <span class="keyword">public</span> ErrorMeasures   <span class="comment">// winner-takes-all &amp; </span>
00045 {
00046  <span class="keyword">public</span>:
00048 
<a name="l00055"></a><a class="code" href="classMyNet.html#a0">00055</a>   <a class="code" href="classMyNet.html#a0">MyNet</a>      (<span class="keyword">const</span> string &amp;filename) :
00056     MSEFFNet(filename) {  }
00058 
<a name="l00062"></a><a class="code" href="classMyNet.html#a1">00062</a>   <a class="code" href="classMyNet.html#a0">MyNet</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> in, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> out,
00063         <span class="keyword">const</span> Array&lt;int&gt; &amp;cmat, <span class="keyword">const</span> Array&lt;double&gt; &amp;wmat) :
00064     MSEFFNet(in, out, cmat, wmat) {}
00065 
00066 
00067 <span class="preprocessor">#ifdef _WINDOWS</span>
00068 <span class="preprocessor"></span>  <span class="keywordtype">double</span> error(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, <span class="keyword">const</span> Array&lt;double&gt; &amp;target) {
00069     <span class="keywordflow">return</span> MSEFFNet::error(input,target);
00070   }
00071   <span class="keywordtype">double</span> derror(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, <span class="keyword">const</span> Array&lt;double&gt; &amp;target,
00072                 <span class="keywordtype">bool</span> returnError = <span class="keyword">true</span>) {
00073     <span class="keywordflow">return</span> MSEFFNet::derror(input,target,returnError);
00074   }
00075   
00076   <span class="keywordtype">void</span> dmodel(<span class="keyword">const</span> Array&lt;double&gt; &amp;input) {
00077     MSEFFNet::dmodel(input);
00078   }
00079   
00080   <span class="keywordtype">void</span> dmodel(<span class="keyword">const</span> Array&lt;double&gt; &amp;input, Array&lt;double&gt; &amp;output) {
00081     MSEFFNet::dmodel(input,output);
00082   }
00083   
00084   <span class="keywordtype">void</span>   model         (<span class="keyword">const</span> Array&lt;double&gt; &amp;input, Array&lt;double&gt; &amp;output) {
00085     FFNet::model(input,output);
00086     
00087   }
00088   
00089   <span class="keywordtype">void</span> df(<span class="keyword">const</span> Array&lt;double&gt; &amp;coeffs, Array&lt;double&gt; &amp;dfdw) {
00090     
00091     <span class="keywordtype">unsigned</span> i, j;  <span class="comment">// denote neurons</span>
00092     <span class="keywordtype">unsigned</span> c;     <span class="comment">// denotes output</span>
00093     <span class="keywordtype">unsigned</span> pos;   <span class="comment">// the actual position in the Array dedw</span>
00094     <span class="keywordtype">double</span> sum;
00095     
00096     <span class="keywordflow">for</span>(i = firstOutputNeuron, c = 0 ; i &lt; numberOfNeurons; i++, c++) {
00097       FFNet::delta(i) =  coeffs(c) * dgOutput(z[i]);
00098     }
00099     
00100     <span class="comment">// hidden units</span>
00101     <span class="keywordflow">for</span>(j = firstOutputNeuron - 1; j &gt;= inputDimension; j--) {
00102       sum = 0;
00103       <span class="keywordflow">for</span>(i = j + 1; i &lt; numberOfNeurons; i++) {
00104         <span class="keywordflow">if</span>(connection(i, j)) sum += weight(i, j) * FFNet::delta(i);
00105       }
00106       FFNet::delta(j) = dg(z[j]) * sum;
00107     }
00108     
00109     <span class="comment">// calculate error gradient</span>
00110     pos = 0;
00111     <span class="keywordflow">for</span>(i = inputDimension; i &lt; numberOfNeurons; i++) {
00112       <span class="keywordflow">for</span>(j = 0; j &lt; i; j++) {
00113         <span class="keywordflow">if</span>(connection(i, j)) {
00114           dfdw(pos) -= FFNet::delta(i) * z[j];
00115           pos++;
00116         }
00117       }
00118       <span class="keywordflow">if</span>(connection(i, bias)) {  <span class="comment">// bias</span>
00119         dfdw(pos) -= FFNet::delta(i); 
00120         pos++;
00121       }
00122     }
00123   };
00124   
00125 <span class="preprocessor">#endif</span>
00126 <span class="preprocessor"></span>  
00127   
00128   
00129   
<a name="l00131"></a><a class="code" href="classMyNet.html#a2">00131</a>   <span class="keywordtype">double</span> <a class="code" href="classMyNet.html#a2">g</a>       (<span class="keywordtype">double</span> a)  { <span class="keywordflow">return</span> a / (1 + fabs(a)); }
00132   <span class="keywordtype">double</span> dg      (<span class="keywordtype">double</span> ga) { <span class="keywordflow">return</span>  (1 - sgn(ga) * ga) * (1 - sgn(ga) * ga); };
00133 
<a name="l00135"></a><a class="code" href="classMyNet.html#a4">00135</a>   <span class="keywordtype">double</span> <a class="code" href="classMyNet.html#a4">gOutput</a>       (<span class="keywordtype">double</span> a)  { <span class="keywordflow">return</span> a; }
00136   <span class="keywordtype">double</span> dgOutput      (<span class="keywordtype">double</span> ga) { <span class="keywordflow">return</span> 1; };
00137 };
00138 <span class="preprocessor">#endif</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Jun 4 14:20:51 2004 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
