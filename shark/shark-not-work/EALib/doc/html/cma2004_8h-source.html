<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>EALib: cma2004.h Source File</title>
<link href="EALib.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>cma2004.h</h1><a href="cma2004_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//===========================================================================</span>
<a name="l00058"></a>00058 <span class="comment"></span><span class="comment">//===========================================================================</span>
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;<a class="code" href="sqr_8h.html">EALib/sqr.h</a>&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;<a class="code" href="_population_8h.html">EALib/Population.h</a>&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;Array/ArrayOp.h&gt;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &lt;Array/ArrayIo.h&gt;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &lt;LinAlg/linalg.h&gt;</span>
<a name="l00070"></a><a class="code" href="class_c_m_a2004.html">00070</a> <span class="keyword">class </span><a class="code" href="class_c_m_a2004.html">CMA2004</a> {
<a name="l00071"></a>00071 <span class="keyword">public</span>:
<a name="l00072"></a><a class="code" href="class_c_m_a2004.html#504227cda029900cf47a4b984cc2c93d">00072</a>   <a class="code" href="class_c_m_a2004.html#504227cda029900cf47a4b984cc2c93d">~CMA2004</a>() {}
<a name="l00073"></a><a class="code" href="class_c_m_a2004.html#644183f39f3e33588c530d4ad345b21b">00073</a>   <a class="code" href="class_c_m_a2004.html#644183f39f3e33588c530d4ad345b21b">CMA2004</a>()  {}
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8">00075</a>   <span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b84b50aad8d41b6860451b33df609d5a28">equal</a>, <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b839612dfdcbb7b7e454627cde6f97f9eb">linear</a>, <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8717f200a29828dd711bccdb8cd3bc822">superlinear</a> } <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8">RecombType</a>;
<a name="l00076"></a><a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5d">00076</a>   <span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5d51178950aa2f5e71dbcb26bbc2d32783">source</a>, <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5dd8a424fc0dc211c621f2b2ca7add5db8">source2</a>, <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5de89de94fbcd43a62f31bdccf027960e2">paper</a> }     <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5d">InitType</a>;
<a name="l00077"></a><a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb256">00077</a>   <span class="keyword">typedef</span> <span class="keyword">enum</span> { <a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb25655070296c1c6b64b93b37ad1b2c0a09f">rankone</a>, <a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb256cf2861445757e1e1e300c4ecdbd125a6">rankmu</a> }            <a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb256">UpdateType</a>;
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="class_c_m_a2004.html#5a79580fe476ac5f4dbb01df72783d2b">00079</a>   <span class="keywordtype">unsigned</span> <a class="code" href="class_c_m_a2004.html#5a79580fe476ac5f4dbb01df72783d2b">suggestLambda</a>(<span class="keywordtype">unsigned</span> dimension) {
<a name="l00080"></a>00080     <span class="keywordtype">unsigned</span> <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>             = unsigned( 4. + floor(3. * log((<span class="keywordtype">double</span>) dimension)) );
<a name="l00081"></a>00081     <span class="comment">// heuristics for small search spaces</span>
<a name="l00082"></a>00082     <span class="keywordflow">if</span>(lambda &gt; dimension) lambda = dimension; <span class="comment">// CI's golden rule :-)</span>
<a name="l00083"></a>00083     <span class="keywordflow">if</span>(lambda &lt; 5) lambda = 5; <span class="comment">// Hansen &amp; Ostermeier's lower bound</span>
<a name="l00084"></a>00084     <span class="keywordflow">return</span> lambda;
<a name="l00085"></a>00085   }
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="class_c_m_a2004.html#230923ba50781852f50a4c1030cc67e3">00087</a>   <span class="keywordtype">unsigned</span> <a class="code" href="class_c_m_a2004.html#230923ba50781852f50a4c1030cc67e3">suggestMu</a>(<span class="keywordtype">unsigned</span> <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>, <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8">RecombType</a> recomb = <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8717f200a29828dd711bccdb8cd3bc822">superlinear</a>) { 
<a name="l00088"></a>00088     <span class="keywordflow">if</span>(recomb == <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b84b50aad8d41b6860451b33df609d5a28">equal</a>) <span class="keywordflow">return</span>  unsigned( floor(lambda / 4.) ); 
<a name="l00089"></a>00089     <span class="keywordflow">return</span>  unsigned( floor(lambda / 2.) );
<a name="l00090"></a>00090   }
<a name="l00091"></a>00091     
<a name="l00092"></a><a class="code" href="class_c_m_a2004.html#cd5c4b2ebb5979cbc61128beabd75e25">00092</a>   <span class="keywordtype">void</span> <a class="code" href="class_c_m_a2004.html#cd5c4b2ebb5979cbc61128beabd75e25">init</a>(<span class="keywordtype">unsigned</span> dimension, 
<a name="l00093"></a>00093             std::vector&lt;double &gt; var, <span class="keywordtype">double</span> _sigma, 
<a name="l00094"></a>00094             <a class="code" href="class_population.html">Population</a> &amp;p, 
<a name="l00095"></a>00095             <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8">RecombType</a> recomb  = <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8717f200a29828dd711bccdb8cd3bc822">superlinear</a>, 
<a name="l00096"></a>00096             <a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb256">UpdateType</a> cupdate = <a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb256cf2861445757e1e1e300c4ecdbd125a6">rankmu</a>, 
<a name="l00097"></a>00097             <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5d">InitType</a> <a class="code" href="class_c_m_a2004.html#cd5c4b2ebb5979cbc61128beabd75e25">init</a>      = <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5de89de94fbcd43a62f31bdccf027960e2">paper</a>) {
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="keywordtype">unsigned</span> mu = p.<a class="code" href="class_population.html#fd59ccfaf65813549e6ea756ef0fb54b">size</a>();
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>     = dimension;
<a name="l00102"></a>00102     <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a> = _sigma;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>.resize         (mu);
<a name="l00105"></a>00105     <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>.<a class="code" href="class_chromosome_t__base.html#f222e374790b377bce4ce137b9c8b679">resize</a>         (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00106"></a>00106     <a class="code" href="class_c_m_a2004.html#a6251219867783f96b9f7250a71d11d1">xPrime</a>.<a class="code" href="class_chromosome_t__base.html#f222e374790b377bce4ce137b9c8b679">resize</a>    (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00107"></a>00107     <a class="code" href="class_c_m_a2004.html#c1f7ab7e10574eb2efe1fdf12cc2132f">z</a>.resize         (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00108"></a>00108     <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>.resize        (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00109"></a>00109     <a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">ps</a>.resize        (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00110"></a>00110     <a class="code" href="class_c_m_a2004.html#c5ed6fa93569118586f39f009646a4e5">Z</a>.resize         (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>, <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00111"></a>00111     <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>.resize         (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>, <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00112"></a>00112     <a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">B</a>.resize         (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>, <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00113"></a>00113     <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>.resize    (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00114"></a>00114     <a class="code" href="class_c_m_a2004.html#c138e4b75bf41cbe56691943b89b38b8">theVector</a>.resize (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00115"></a>00115     <a class="code" href="class_c_m_a2004.html#e629ffdfc104fa5d259f6a2fd2be611c">meanz</a>.<a class="code" href="class_chromosome_t__base.html#f222e374790b377bce4ce137b9c8b679">resize</a>     (<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00116"></a>00116 
<a name="l00117"></a>00117     <span class="keywordflow">switch</span>(recomb) {
<a name="l00118"></a>00118     <span class="keywordflow">case</span> <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b84b50aad8d41b6860451b33df609d5a28">equal</a>:
<a name="l00119"></a>00119       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; mu; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = 1;
<a name="l00120"></a>00120       <span class="keywordflow">break</span>;
<a name="l00121"></a>00121     <span class="keywordflow">case</span> <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b839612dfdcbb7b7e454627cde6f97f9eb">linear</a>: 
<a name="l00122"></a>00122       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; mu; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = mu - <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>;
<a name="l00123"></a>00123       <span class="keywordflow">break</span>;
<a name="l00124"></a>00124     <span class="keywordflow">case</span> <a class="code" href="class_c_m_a2004.html#dee7c78faf644071b8a044a28ed3c1b8717f200a29828dd711bccdb8cd3bc822">superlinear</a>: 
<a name="l00125"></a>00125       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; mu; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = log(mu + 1.) - log(1. + <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>);
<a name="l00126"></a>00126       <span class="keywordflow">break</span>;
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <span class="keywordtype">double</span> wSum    = 0;
<a name="l00130"></a>00130     <span class="keywordtype">double</span> wSumSqr = 0;
<a name="l00131"></a>00131     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; mu; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) {
<a name="l00132"></a>00132       wSum += <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>);
<a name="l00133"></a>00133       wSumSqr += <a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(<a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>));
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135     <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a> /= wSum; <span class="comment">// normalizing weights</span>
<a name="l00136"></a>00136     wSumSqr /= <a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(wSum);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     <a class="code" href="class_c_m_a2004.html#63d42f6b5a3d59c0b5ff2bc423e87dd3">cc</a>      = 4. / (4. + <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00139"></a>00139     <a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">cs</a>      = 10. / (20. + <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>);
<a name="l00140"></a>00140     <a class="code" href="class_c_m_a2004.html#f4f5f91d248c3ef435df11db9c61dc8b">ccu</a>     = sqrt((2.-<a class="code" href="class_c_m_a2004.html#63d42f6b5a3d59c0b5ff2bc423e87dd3">cc</a>) * <a class="code" href="class_c_m_a2004.html#63d42f6b5a3d59c0b5ff2bc423e87dd3">cc</a>);
<a name="l00141"></a>00141     <a class="code" href="class_c_m_a2004.html#4e6b80da81d397f0645e94d4e1584a45">csu</a>     = sqrt((2.-<a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">cs</a>) * <a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">cs</a>);
<a name="l00142"></a>00142     <a class="code" href="class_c_m_a2004.html#636197fc028182599a47761d5d6fedef">chi_n</a>   = sqrt( <span class="keywordtype">double</span>(<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>) ) * (1 - 1. / (4. * n) +  1. / (21. * <a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>( <span class="keywordtype">double</span>(n))));
<a name="l00143"></a>00143       
<a name="l00144"></a>00144     <a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a>   = 1 / wSumSqr;
<a name="l00145"></a>00145     <a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a>   = <a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a>;
<a name="l00146"></a>00146     <span class="keywordflow">if</span>(cupdate == <a class="code" href="class_c_m_a2004.html#e026feb9b42098eeb13b6355f17cb25655070296c1c6b64b93b37ad1b2c0a09f">rankone</a>) <a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a> = 1.;
<a name="l00147"></a>00147     <a class="code" href="class_c_m_a2004.html#be2521f396ca1f5305b0aca834a5831e">d</a>       = <a class="code" href="_chromosome_c_m_a_8h.html#a79d2df4c12f8f4927d88ddf7519e4c8">max</a>(1., 3*<a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a> / (n + 10.)) + cs; <span class="comment">// 1./cs;</span>
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="keywordflow">switch</span>(<a class="code" href="class_c_m_a2004.html#cd5c4b2ebb5979cbc61128beabd75e25">init</a>) {
<a name="l00150"></a>00150     <span class="keywordflow">case</span> <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5d51178950aa2f5e71dbcb26bbc2d32783">source</a>:
<a name="l00151"></a>00151       <a class="code" href="class_c_m_a2004.html#87d19c8d6cfd6cd9d2c935740c2e464e">ccov</a>     = 1./<a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a> * 2./<a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(n + (2.)) 
<a name="l00152"></a>00152         + (1 - 1./<a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a>) * (2*<a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a> - 1) / (<a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(n + 2) + 2 * <a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a>);
<a name="l00153"></a>00153       <span class="keywordflow">break</span>;
<a name="l00154"></a>00154     <span class="keywordflow">case</span> <a class="code" href="class_c_m_a2004.html#596302aa46da65095a021804c9e77b5de89de94fbcd43a62f31bdccf027960e2">paper</a>:
<a name="l00155"></a>00155       <a class="code" href="class_c_m_a2004.html#87d19c8d6cfd6cd9d2c935740c2e464e">ccov</a>     = 1./<a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a> * 2./<a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(n + sqrt(2.)) 
<a name="l00156"></a>00156         + (1 - 1./<a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a>) * <a class="code" href="_chromosome_c_m_a_8h.html#f1c964f667d5c4f45086b782b9db4759">min</a>(1., (2*<a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a> - 1) / (<a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(n + 2) + <a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a>));
<a name="l00157"></a>00157       <span class="keywordflow">break</span>;
<a name="l00158"></a>00158     <span class="keywordflow">default</span>:
<a name="l00159"></a>00159       cerr &lt;&lt; <span class="stringliteral">"unknow CMA initialization command"</span> &lt;&lt; endl;
<a name="l00160"></a>00160       exit(EXIT_FAILURE);
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162                                                                       
<a name="l00163"></a>00163     <span class="comment">// init COG                                                               </span>
<a name="l00164"></a>00164     <a class="code" href="class_c_m_a2004.html#8190cf0c39daf76189344d99cf34d87b">cog</a>(<a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>, p);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166     <span class="comment">// init paths</span>
<a name="l00167"></a>00167     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; n; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) {
<a name="l00168"></a>00168       <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = <a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">ps</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = 0.;
<a name="l00169"></a>00169       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> = 0; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> &lt; n; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>++) {
<a name="l00170"></a>00170         <span class="keywordflow">if</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>!=<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>) <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>,<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>) = 0;
<a name="l00171"></a>00171         <span class="keywordflow">else</span> <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>(i,<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>) = var[i];
<a name="l00172"></a>00172       }
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174     
<a name="l00175"></a>00175     <span class="comment">// eigenvalues lambda and eigenvector matrix B</span>
<a name="l00176"></a>00176     eigensymm(<a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>, <a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">B</a>, <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>);
<a name="l00177"></a>00177   }
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="class_c_m_a2004.html#ccc6e950e3d32c442e8abfaba3aea438">00179</a>   <span class="keywordtype">void</span> <a class="code" href="class_c_m_a2004.html#cd5c4b2ebb5979cbc61128beabd75e25">init</a>(<span class="keywordtype">unsigned</span> dimension, <span class="keywordtype">double</span> _sigma,  <a class="code" href="class_population.html">Population</a> &amp;p) {
<a name="l00180"></a>00180     std::vector&lt;double&gt; var(dimension);
<a name="l00181"></a>00181     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; dimension; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) var[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>] = 1;
<a name="l00182"></a>00182     <a class="code" href="class_c_m_a2004.html#cd5c4b2ebb5979cbc61128beabd75e25">init</a>(dimension, var, _sigma, p);
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   <span class="comment">//</span>
<a name="l00186"></a>00186   <span class="comment">// calculate weighted mean</span>
<a name="l00187"></a>00187   <span class="comment">//</span>
<a name="l00188"></a><a class="code" href="class_c_m_a2004.html#8190cf0c39daf76189344d99cf34d87b">00188</a>   <span class="keywordtype">void</span> <a class="code" href="class_c_m_a2004.html#8190cf0c39daf76189344d99cf34d87b">cog</a>(<a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double &gt;</a>&amp; a, <a class="code" href="class_population.html">Population</a> &amp;p, <span class="keywordtype">unsigned</span> c = 0) {
<a name="l00189"></a>00189     SIZE_CHECK( <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a> == <span class="keyword">dynamic_cast</span>&lt;<a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double &gt;</a>&amp; &gt;(p[0][c]).size() );
<a name="l00190"></a>00190     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> = 0; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> &lt; <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>++) {
<a name="l00191"></a>00191       a[<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>] = <span class="keyword">dynamic_cast</span>&lt; <a class="code" href="class_chromosome_t_3_01double_01_4.html">ChromosomeT&lt; double &gt;</a>&amp; &gt;(p[0][c])[<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>] * <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(0);
<a name="l00192"></a>00192       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 1; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; p.<a class="code" href="class_population.html#fd59ccfaf65813549e6ea756ef0fb54b">size</a>(); <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) {
<a name="l00193"></a>00193         a[j] += <span class="keyword">dynamic_cast</span>&lt; <a class="code" href="class_chromosome_t_3_01double_01_4.html">ChromosomeT&lt; double &gt;</a>&amp; &gt;(p[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>][c])[j] * <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>);
<a name="l00194"></a>00194       }
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196   }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   <span class="comment">//</span>
<a name="l00199"></a>00199   <span class="comment">// mutation after global intermediate recombination</span>
<a name="l00200"></a>00200   <span class="comment">//</span>
<a name="l00201"></a><a class="code" href="class_c_m_a2004.html#8b14ea198508b753b2e1181afefeb05c">00201</a>   <span class="keywordtype">void</span> <a class="code" href="class_c_m_a2004.html#8b14ea198508b753b2e1181afefeb05c">create</a>(<a class="code" href="class_individual.html">Individual</a> &amp;o) {
<a name="l00202"></a>00202     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) {
<a name="l00203"></a>00203       <span class="comment">// draw random vector</span>
<a name="l00204"></a>00204       <a class="code" href="class_c_m_a2004.html#c1f7ab7e10574eb2efe1fdf12cc2132f">z</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = Rng::gauss(0,1);
<a name="l00205"></a>00205       dynamic_cast&lt; ChromosomeT&lt; double &gt;&amp; &gt;(o[1])[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>] = <a class="code" href="class_c_m_a2004.html#c1f7ab7e10574eb2efe1fdf12cc2132f">z</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>);
<a name="l00206"></a>00206       <span class="comment">// global intermediate recombination, Eq. (1)</span>
<a name="l00207"></a>00207       dynamic_cast&lt; ChromosomeT&lt; double &gt;&amp; &gt;(o[0])[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>] = <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>];
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     <span class="comment">// mutate objective variables, Eq. (1)</span>
<a name="l00211"></a>00211     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; n; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++)
<a name="l00212"></a>00212       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> = 0; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> &lt; n; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>++) 
<a name="l00213"></a>00213         <span class="keyword">dynamic_cast</span>&lt; <a class="code" href="class_chromosome_t_3_01double_01_4.html">ChromosomeT&lt; double &gt;</a>&amp; &gt;(o[0])[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>] += <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a> * <a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">B</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>,<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>) * sqrt(fabs(<a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>(<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>))) * <a class="code" href="class_c_m_a2004.html#c1f7ab7e10574eb2efe1fdf12cc2132f">z</a>(j);
<a name="l00214"></a>00214   }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="comment">//</span>
<a name="l00217"></a>00217   <span class="comment">// do the CMA</span>
<a name="l00218"></a>00218   <span class="comment">//</span>
<a name="l00219"></a><a class="code" href="class_c_m_a2004.html#e96d9229e16e09d98c5717b05243e8d1">00219</a>   <span class="keywordtype">void</span> <a class="code" href="class_c_m_a2004.html#e96d9229e16e09d98c5717b05243e8d1">updateStrategyParameters</a>(<a class="code" href="class_population.html">Population</a> &amp;p, <span class="keywordtype">double</span> lowerBound = .0) {
<a name="l00220"></a>00220     <span class="keywordtype">double</span> normPS = 0.;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="comment">// COG of new parents</span>
<a name="l00223"></a>00223     <a class="code" href="class_c_m_a2004.html#8190cf0c39daf76189344d99cf34d87b">cog</a>(<a class="code" href="class_c_m_a2004.html#a6251219867783f96b9f7250a71d11d1">xPrime</a>, p);
<a name="l00224"></a>00224     <a class="code" href="class_c_m_a2004.html#8190cf0c39daf76189344d99cf34d87b">cog</a>(<a class="code" href="class_c_m_a2004.html#e629ffdfc104fa5d259f6a2fd2be611c">meanz</a> , p, 1);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <a class="code" href="class_c_m_a2004.html#c138e4b75bf41cbe56691943b89b38b8">theVector</a> = 0;
<a name="l00227"></a>00227     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++)
<a name="l00228"></a>00228       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> = 0; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> &lt; n; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>++)
<a name="l00229"></a>00229         <a class="code" href="class_c_m_a2004.html#c138e4b75bf41cbe56691943b89b38b8">theVector</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) += <a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">B</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>,<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>) * <a class="code" href="class_c_m_a2004.html#e629ffdfc104fa5d259f6a2fd2be611c">meanz</a>[<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>];
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     <span class="comment">// Eq. (2) &amp; Eq. (4)</span>
<a name="l00232"></a>00232     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; n; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) {
<a name="l00233"></a>00233       <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) = (1 - <a class="code" href="class_c_m_a2004.html#63d42f6b5a3d59c0b5ff2bc423e87dd3">cc</a>) * <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>) + <a class="code" href="class_c_m_a2004.html#f4f5f91d248c3ef435df11db9c61dc8b">ccu</a> * sqrt(<a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a>) / <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a> * (<a class="code" href="class_c_m_a2004.html#a6251219867783f96b9f7250a71d11d1">xPrime</a>[i] - <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>[i]);
<a name="l00234"></a>00234       <a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">ps</a>(i) = (1 - <a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">cs</a>) * <a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">ps</a>(i) + <a class="code" href="class_c_m_a2004.html#4e6b80da81d397f0645e94d4e1584a45">csu</a> * sqrt(mueff) * <a class="code" href="class_c_m_a2004.html#c138e4b75bf41cbe56691943b89b38b8">theVector</a>(i);
<a name="l00235"></a>00235       normPS += <a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(<a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">ps</a>(i));
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     normPS  = sqrt( normPS );
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <span class="comment">// Eq. (3)</span>
<a name="l00240"></a>00240     <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> = 0; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a> &lt; n; <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>++) 
<a name="l00241"></a>00241       <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> = 0; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> &lt; n; <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>++)
<a name="l00242"></a>00242         <span class="keywordflow">for</span>(<a class="code" href="class_c_m_a2004.html#c5ed6fa93569118586f39f009646a4e5">Z</a>[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>][<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>] = 0., <a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a> = 0; <a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a> &lt; p.<a class="code" href="class_population.html#fd59ccfaf65813549e6ea756ef0fb54b">size</a>(); <a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a>++)
<a name="l00243"></a>00243           <a class="code" href="class_c_m_a2004.html#c5ed6fa93569118586f39f009646a4e5">Z</a>(<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>, <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a> ) += <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>(<a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a>) * (dynamic_cast&lt; ChromosomeT&lt; double &gt;&amp; &gt;(p[<a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a>][0])[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>] - <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>[<a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>]) *
<a name="l00244"></a>00244             (dynamic_cast&lt; ChromosomeT&lt; double &gt;&amp; &gt;(p[<a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a>][0])[<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>] - <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>[<a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>]);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     <span class="keywordflow">for</span>(i = 0; i &lt; n; i++) 
<a name="l00247"></a>00247       <span class="keywordflow">for</span>(j = 0; j &lt; n; j++)
<a name="l00248"></a>00248         <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>(i, j ) = (1 - <a class="code" href="class_c_m_a2004.html#87d19c8d6cfd6cd9d2c935740c2e464e">ccov</a>) * <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>(i, j) + <a class="code" href="class_c_m_a2004.html#87d19c8d6cfd6cd9d2c935740c2e464e">ccov</a> * 
<a name="l00249"></a>00249           (1./<a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a> * <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>(i) * <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>(j) + (1. - 1./<a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a>) * 1./<a class="code" href="sqr_8h.html#dee8c6d2fc20a1194cf64c481e7b6353">sqr</a>(<a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a>) * <a class="code" href="class_c_m_a2004.html#c5ed6fa93569118586f39f009646a4e5">Z</a>(i, j));
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     <span class="comment">// Eq. (5)</span>
<a name="l00252"></a>00252     <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a> *= exp((<a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">cs</a> / <a class="code" href="class_c_m_a2004.html#be2521f396ca1f5305b0aca834a5831e">d</a>) * (normPS / <a class="code" href="class_c_m_a2004.html#636197fc028182599a47761d5d6fedef">chi_n</a> - 1));
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="comment">// eigenvalues lambda and eigenvector matrix B</span>
<a name="l00255"></a>00255     eigensymm(<a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>, <a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">B</a>, <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <span class="comment">// lower bound</span>
<a name="l00258"></a>00258     <span class="keywordflow">if</span> ((sigma * sqrt(fabs(<a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>(n - 1)))) &lt; lowerBound) 
<a name="l00259"></a>00259       sigma = lowerBound / sqrt(fabs(<a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>(n - 1)));
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="comment">// new COG becomes old COG</span>
<a name="l00262"></a>00262     <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a> = <a class="code" href="class_c_m_a2004.html#a6251219867783f96b9f7250a71d11d1">xPrime</a>;
<a name="l00263"></a>00263   }
<a name="l00264"></a>00264 
<a name="l00265"></a><a class="code" href="class_c_m_a2004.html#2b7c725d6b0e84842479501d21ae7bd9">00265</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#2b7c725d6b0e84842479501d21ae7bd9">getSigma</a>()                 { <span class="keywordflow">return</span> <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a>; }
<a name="l00266"></a><a class="code" href="class_c_m_a2004.html#e60c5fd6f9ace6a057d1fd33a44d26d2">00266</a>   <span class="keywordtype">void</span>   <a class="code" href="class_c_m_a2004.html#e60c5fd6f9ace6a057d1fd33a44d26d2">setSigma</a>(<span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>)         { <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a> = x; }
<a name="l00267"></a><a class="code" href="class_c_m_a2004.html#5b193e28ae87b9560d251034a96e6218">00267</a>   <span class="keywordtype">void</span>   <a class="code" href="class_c_m_a2004.html#5b193e28ae87b9560d251034a96e6218">setChi_n</a>(<span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>)         { <a class="code" href="class_c_m_a2004.html#636197fc028182599a47761d5d6fedef">chi_n</a> = x; }
<a name="l00268"></a><a class="code" href="class_c_m_a2004.html#2285c85c0b498f8719689dc541ffd82e">00268</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#2285c85c0b498f8719689dc541ffd82e">getCondition</a>()             { <span class="keywordflow">return</span> <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>(0) / <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>(<a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>-1); }
<a name="l00269"></a><a class="code" href="class_c_m_a2004.html#c69df6b2c61960f5c19ccc6b24597567">00269</a>   <span class="keyword">const</span>  Array&lt;double&gt; &amp;<a class="code" href="class_c_m_a2004.html#c69df6b2c61960f5c19ccc6b24597567">getC</a>()      { <span class="keywordflow">return</span> <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>; }
<a name="l00270"></a><a class="code" href="class_c_m_a2004.html#adf2f3f3aa8095d7ec448543c688db68">00270</a>   <span class="keyword">const</span>  Array&lt;double&gt; &amp;<a class="code" href="class_c_m_a2004.html#adf2f3f3aa8095d7ec448543c688db68">getLambda</a>() { <span class="keywordflow">return</span> <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>; }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="keyword">private</span>:
<a name="l00273"></a><a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">00273</a>   <span class="keywordtype">unsigned</span> <a class="code" href="class_c_m_a2004.html#58dabb932be1afa01a3cd7eb5d65656d">n</a>;
<a name="l00274"></a><a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">00274</a>   <span class="keywordtype">unsigned</span> <a class="code" href="class_c_m_a2004.html#aafe0f82f6d4d8cd57f7b6f193b49a8c">i</a>, <a class="code" href="class_c_m_a2004.html#08312dbe9dc9d66e30adce11c29e6060">j</a>, <a class="code" href="class_c_m_a2004.html#64adf5b1bdbe70009b20636c57f3dc60">k</a>;
<a name="l00275"></a><a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">00275</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#c9a09d6f1a1ad112ba72ff9110a998ce">sigma</a>;
<a name="l00276"></a><a class="code" href="class_c_m_a2004.html#636197fc028182599a47761d5d6fedef">00276</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#636197fc028182599a47761d5d6fedef">chi_n</a>;
<a name="l00277"></a><a class="code" href="class_c_m_a2004.html#63d42f6b5a3d59c0b5ff2bc423e87dd3">00277</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#63d42f6b5a3d59c0b5ff2bc423e87dd3">cc</a>;
<a name="l00278"></a><a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">00278</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#14a1780c7f60f3146aa13d457c98662d">cs</a>;
<a name="l00279"></a><a class="code" href="class_c_m_a2004.html#4e6b80da81d397f0645e94d4e1584a45">00279</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#4e6b80da81d397f0645e94d4e1584a45">csu</a>;
<a name="l00280"></a><a class="code" href="class_c_m_a2004.html#f4f5f91d248c3ef435df11db9c61dc8b">00280</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#f4f5f91d248c3ef435df11db9c61dc8b">ccu</a>;
<a name="l00281"></a><a class="code" href="class_c_m_a2004.html#87d19c8d6cfd6cd9d2c935740c2e464e">00281</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#87d19c8d6cfd6cd9d2c935740c2e464e">ccov</a>;
<a name="l00282"></a><a class="code" href="class_c_m_a2004.html#be2521f396ca1f5305b0aca834a5831e">00282</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#be2521f396ca1f5305b0aca834a5831e">d</a>;
<a name="l00283"></a><a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">00283</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#6af0bf68f18d2c84ba3b4e40f2b73c94">mueff</a>;
<a name="l00284"></a><a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">00284</a>   <span class="keywordtype">double</span> <a class="code" href="class_c_m_a2004.html#fd1ac90bdc0c20e2fd6c0b2883f57cb4">mucov</a>;
<a name="l00285"></a>00285 
<a name="l00286"></a><a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">00286</a>   <a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double&gt;</a> <a class="code" href="class_c_m_a2004.html#36479a58b9a1bc325faeaf1da4d6bb1d">x</a>;
<a name="l00287"></a><a class="code" href="class_c_m_a2004.html#a6251219867783f96b9f7250a71d11d1">00287</a>   <a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double&gt;</a> <a class="code" href="class_c_m_a2004.html#a6251219867783f96b9f7250a71d11d1">xPrime</a>;
<a name="l00288"></a><a class="code" href="class_c_m_a2004.html#e629ffdfc104fa5d259f6a2fd2be611c">00288</a>   <a class="code" href="class_chromosome_t.html">ChromosomeT&lt;double&gt;</a> <a class="code" href="class_c_m_a2004.html#e629ffdfc104fa5d259f6a2fd2be611c">meanz</a>;
<a name="l00289"></a>00289 
<a name="l00290"></a><a class="code" href="class_c_m_a2004.html#c1f7ab7e10574eb2efe1fdf12cc2132f">00290</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#c1f7ab7e10574eb2efe1fdf12cc2132f">z</a>;
<a name="l00291"></a><a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">00291</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#06c3b86d3805e0865554f66e5be29817">pc</a>;
<a name="l00292"></a><a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">00292</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#cd126503eb3270e87e118e81cfa41f9f">ps</a>;
<a name="l00293"></a><a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">00293</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#d7dfb2211429bcb556175a70ee023358">C</a>;
<a name="l00294"></a><a class="code" href="class_c_m_a2004.html#c5ed6fa93569118586f39f009646a4e5">00294</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#c5ed6fa93569118586f39f009646a4e5">Z</a>;
<a name="l00295"></a><a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">00295</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#8820d514d1ab3cde4ad52ed5d513b203">lambda</a>;
<a name="l00296"></a><a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">00296</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#d00b96b02cfbf6dfe1913e0584858fcf">B</a>;
<a name="l00297"></a><a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">00297</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#80c2dfa01449ed956042c9fc5790345e">w</a>;
<a name="l00298"></a><a class="code" href="class_c_m_a2004.html#c138e4b75bf41cbe56691943b89b38b8">00298</a>   Array&lt;double&gt; <a class="code" href="class_c_m_a2004.html#c138e4b75bf41cbe56691943b89b38b8">theVector</a>;
<a name="l00299"></a>00299 };
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Mar 23 10:37:02 2009 for EALib by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
