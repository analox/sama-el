<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReClaM: StochasticGradientDescent Class Reference</title>
<link href="ReClaM.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="annotated.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>StochasticGradientDescent Class Reference</h1><!-- doxytag: class="StochasticGradientDescent" --><!-- doxytag: inherits="ModelInterface" -->Learning strategies based on <a class="el" href="class_steepest_descent.html">SteepestDescent</a>, but with randomly chosen patterns.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a>&gt;</code>
<p>
<p>Inheritance diagram for StochasticGradientDescent:
<p><center><img src="class_stochastic_gradient_descent.png" usemap="#StochasticGradientDescent_map" border="0" alt=""></center>
<map name="StochasticGradientDescent_map">
<area href="class_model_interface.html" alt="ModelInterface" shape="rect" coords="0,0,164,24">
</map>
<a href="class_stochastic_gradient_descent-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#15a9b072d36f396120f1c41435f82fab">learn</a> (const Array&lt; double &gt; &amp;<a class="el" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, const Array&lt; double &gt; &amp;target, double lr=0.1, double mu=0.3)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Iterative update of weights, patterns are randomly chosen, each pattern only once.  <a href="#15a9b072d36f396120f1c41435f82fab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#bf6991cf57d08e538a518b7a50f8f66d">learnfast</a> (const Array&lt; double &gt; &amp;<a class="el" href="_adp_b_p_8h.html#faabd99e32d62d06313dac12ae518da6">in</a>, const Array&lt; double &gt; &amp;target, double lr=0.1, double mu=0.3)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Iterative update of weights, patterns are randomly chosen.  <a href="#bf6991cf57d08e538a518b7a50f8f66d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#f12c4f9025470a46080923948ae36cfd">clearMemory</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clears the array of momentum values.  <a href="#f12c4f9025470a46080923948ae36cfd"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_stochastic_gradient_descent.html#772b7c4324ed6a79fb077ac9c76f07c7">clearMomentumMemory</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clears the array of momentum values.  <a href="#772b7c4324ed6a79fb077ac9c76f07c7"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Learning strategies based on <a class="el" href="class_steepest_descent.html">SteepestDescent</a>, but with randomly chosen patterns. 
<p>
Similar to the most simple learning strategy <a class="el" href="class_steepest_descent.html">SteepestDescent</a>, the weights of the network are iteratively updated to minimize the error. When working with more than one pattern and gradient descent, all patterns are sequentially presented to the network and the weight update takes place after every pattern. Here you will find two methods that work on the base of <a class="el" href="class_steepest_descent.html">SteepestDescent</a>, but that will chose the next pattern for presentation by random.<p>
<dl compact><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes:</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status:</b></dt><dd>stable </dd></dl>

<p>

<p>
Definition at line <a class="el" href="_stochastic_gradient_descent_8h-source.html#l00111">111</a> of file <a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a>.<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="f12c4f9025470a46080923948ae36cfd"></a><!-- doxytag: member="StochasticGradientDescent::clearMemory" ref="f12c4f9025470a46080923948ae36cfd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::clearMemory           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clears the array of momentum values. 
<p>
The momentum values are the values that are added to the weights for updating.<p>
<dl compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_stochastic_gradient_descent_8h-source.html#l00248">248</a> of file <a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a>.
</div>
</div><p>
<a class="anchor" name="772b7c4324ed6a79fb077ac9c76f07c7"></a><!-- doxytag: member="StochasticGradientDescent::clearMomentumMemory" ref="772b7c4324ed6a79fb077ac9c76f07c7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::clearMomentumMemory           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clears the array of momentum values. 
<p>
The momentum values are the values that are added to the weights for updating.<p>
<dl compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_stochastic_gradient_descent_8h-source.html#l00273">273</a> of file <a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a>.
</div>
</div><p>
<a class="anchor" name="15a9b072d36f396120f1c41435f82fab"></a><!-- doxytag: member="StochasticGradientDescent::learn" ref="15a9b072d36f396120f1c41435f82fab" args="(const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target, double lr=0.1, double mu=0.3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::learn           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lr</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mu</em> = <code>0.3</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Iterative update of weights, patterns are randomly chosen, each pattern only once. 
<p>
Similar to <a class="el" href="class_steepest_descent.html">SteepestDescent</a>, where the weights are iteratively updated by moving a short distance in the direction of the greatest decrease of the error, i.e. in the direction of the negative gradient by using the error derivatives <a class="el" href="class_model_interface.html#8ef52ebca3fbb98f2b4acf3a04426189">dedw</a>. Additionally a momentum term is added to the gradient descent to deal with the problem of widely differing eigenvalues. The update of a weight at time <img class="formulaInl" alt="$t$" src="form_82.png"> to a weight at time <img class="formulaInl" alt="$t+1$" src="form_280.png"> is then given as<p>
<img class="formulaInl" alt="$ \omega_{t+1} = \omega_t + \eta \nabla f(\omega_t) + \mu \Delta w_t $" src="form_282.png"><p>
In contrast to <a class="el" href="class_steepest_descent.html">SteepestDescent</a> the weights for more than one pattern are not updated by choosing the patterns sequentially, but randomly. Compared to <a class="el" href="class_stochastic_gradient_descent.html#bf6991cf57d08e538a518b7a50f8f66d">learnfast</a> a pattern can not be chosen more than once.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Input vector for the model. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target</em>&nbsp;</td><td>Target vector. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lr</em>&nbsp;</td><td>Learning rate <img class="formulaInl" alt="$ \eta $" src="form_278.png">. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mu</em>&nbsp;</td><td>Momentum parameter <img class="formulaInl" alt="$ \mu $" src="form_279.png">. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_stochastic_gradient_descent_8h-source.html#l00154">154</a> of file <a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00221">ModelInterface::dedw</a>, <a class="el" href="_model_interface_8h-source.html#l00302">ModelInterface::derror()</a>, and <a class="el" href="_model_interface_8h-source.html#l00199">ModelInterface::w</a>.
</div>
</div><p>
<a class="anchor" name="bf6991cf57d08e538a518b7a50f8f66d"></a><!-- doxytag: member="StochasticGradientDescent::learnfast" ref="bf6991cf57d08e538a518b7a50f8f66d" args="(const Array&lt; double &gt; &amp;in, const Array&lt; double &gt; &amp;target, double lr=0.1, double mu=0.3)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void StochasticGradientDescent::learnfast           </td>
          <td>(</td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>lr</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>mu</em> = <code>0.3</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Iterative update of weights, patterns are randomly chosen. 
<p>
Similar to <a class="el" href="class_stochastic_gradient_descent.html#15a9b072d36f396120f1c41435f82fab">learn</a>, but to save time it is not checked here whether a pattern was already chosen.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in</em>&nbsp;</td><td>Input vector for the model. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>target</em>&nbsp;</td><td>Target vector. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lr</em>&nbsp;</td><td>Learning rate <img class="formulaInl" alt="$ \eta $" src="form_278.png">. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mu</em>&nbsp;</td><td>Momentum parameter <img class="formulaInl" alt="$ \mu $" src="form_279.png">. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>None.</dd></dl>
<dl compact><dt><b>Author:</b></dt><dd>P. Stagge </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>1999</dd></dl>
<dl compact><dt><b>Changes</b></dt><dd>none</dd></dl>
<dl compact><dt><b>Status</b></dt><dd>stable </dd></dl>

<p>
Definition at line <a class="el" href="_stochastic_gradient_descent_8h-source.html#l00207">207</a> of file <a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a>.
<p>
References <a class="el" href="_model_interface_8h-source.html#l00221">ModelInterface::dedw</a>, <a class="el" href="_model_interface_8h-source.html#l00302">ModelInterface::derror()</a>, and <a class="el" href="_model_interface_8h-source.html#l00199">ModelInterface::w</a>.
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_stochastic_gradient_descent_8h-source.html">StochasticGradientDescent.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Dec 16 13:07:17 2009 for ReClaM by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
